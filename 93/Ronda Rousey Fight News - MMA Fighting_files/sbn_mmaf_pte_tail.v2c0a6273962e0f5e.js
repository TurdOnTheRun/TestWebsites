/*!
 * Play GIF
 *
 * by Jesse Young
 *
 * a jQuery plugin to play GIF animations on mouseover (or any other event).
 *
 * Examples:
 *    $('img[src$=".gif"]').playGIF();             // default is mouseover
 *    $('img[src$=".gif"]').playGIF({on:'click'}); // play animation on click
 */
function BrightcoveWrapper(e,t,o){var a=this,r=function(){},n="4063572901001";this.$el=jQuery("#"+e),this.elementId=e,this.meta=t,this.meta.type="brightcove",this.options=o=jQuery.extend({autoplay:!1,account_id:n,callback:r,onAdsPlayed:r,onCreate:r,onPlay:r},window.brightcove_options||{},o||{}),this.insertVideoTag.call(this,this.$el),this.perfMark("brightcoveInitializeStart"),yepnope({load:a.getPlayerUrl(o),complete:function(){a.setupPlayer(o),a.options.callback()}})}function OoyalaWrapper(e,t,o){function a(e){var t=e.mb,a=!1,n=function(a){t.unsubscribe("initialPlay","basePlaying"),t.unsubscribe("playing","basePlaying"),r.perfMark("ooyalaUserPlay"),r.pub("ooyalaVideoPlay"),r.markAsViewed(!0),Chorus.Analytics.event(r.formatEvent("play")),o.onPlay(e,!1),t.subscribe("disablePlaybackControls","basePlaying",function(e){t.unsubscribe("disablePlaybackControls","basePlaying"),r.perfMark("ooyalaFirstFrame"),r.perfMeasure("ttff","ooyalaUserPlay","ooyalaFirstFrame")})};t.subscribe("initialPlay","basePlaying",n),t.subscribe("playing","basePlaying",n),t.subscribe("downloading","basePlaying",function(e,o){t.unsubscribe("downloading","basePlaying"),a=!0}),t.subscribe("embedCodeChanged","discovery",function(e,o){a&&t.subscribe("contentTreeFetched","discovery",function(e,o){t.unsubscribe("contentTreeFetched","discovery");var a=o.title+" | discovery",n=r.formatEvent("play");n.eventLabel=a,Chorus.Analytics.event(n)}),a=!0}),t.subscribe("adsPlayed","taprAdsPlayed",function(e){t.unsubscribe("adsPlayed","taprAdsPlayed"),r.perfMark("ooyalaVideoStart"),t.subscribe("playing","taprPlaying",function(e){t.unsubscribe("playing","taprPlaying"),r.perfMark("ooyalaVideoPlay"),r.perfMeasure("tapr","ooyalaVideoStart","ooyalaVideoPlay")})}),t.subscribe("error","baseError",function(e){Chorus.Analytics.event(r.formatEvent("error"))}),t.subscribe("adsPlayed","baseAdsPlayed",function(a){t.unsubscribe("adsPlayed","baseAdsPlayed"),o.onAdsPlayed(e)}),t.subscribe(window[o.namespace].EVENTS.PLAYBACK_READY,"basePlayer",function(e){t.unsubscribe(window[o.namespace].EVENTS.PLAYBACK_READY,"basePlayer"),r.pub("ooyalaVideoReady"),r.perfMark("ooyalaVideoReady"),r.perfMeasure("loadtime","ooyalaInitializeStart","ooyalaVideoReady"),r.perfLoadComplete()})}var r=this,n=function(){};t.type=t.type||"ooyala",this.$el=jQuery("#"+e),this.elementId=e,this.meta=t,this.options=o=jQuery.extend({autoplay:!1,namespace:"OO",platform:"html5-fallback",player_id:window.ooyala_player_id||"",callback:n,onAdsPlayed:n,onCreate:n,onPlay:n,initialTime:o&&o.hasOwnProperty("volumeStartTime")?o.volumeStartTime:0},window.ooyala_options||{},o||{}),r.perfMark("ooyalaInitializeStart"),yepnope({test:window[o.namespace],nope:r.getOoyalaParams(o),complete:function(){var n=window[o.namespace];n.ready(function(){r.perfLoadStart(),r.player=n.Player.create(e,t.ooyala_id||t.provider_video_id,o),a(r.player),o.callback(r.player)})}})}function YoutubeWrapper(e,t,o){function a(e){e.data===YT.PlayerState.PLAYING?(o.onPlay(r.player),n||(Chorus.Analytics.event(r.formatEvent("play")),r.pub("youtubeVideoPlay"),n=!0)):e.data===YT.PlayerState.PAUSED&&o.onPause(r.player)}var r=this,n=!1,i=function(){};t.type=t.type||"youtube";var s=jQuery("<div>").attr("id","youtube-video-inside-wrapper-"+e);jQuery("#"+e).html(s),e=s.attr("id"),this.$el=jQuery("#"+e),this.elementId=e,this.meta=t,this.options=o=jQuery.extend({autoplay:!1,controls:1,modestbranding:1,rel:0,showInfo:0,onAdsPlayed:i,onCreate:i,onPause:i,onPlay:i,onPlayerReady:i,onPreRollEnd:i,timedEvents:{},start:o.hasOwnProperty("volumeStartTime")?o.volumeStartTime:0},o||{}),o.autoplay=o.autoplay?1:0,Chorus.Video.youtubeApiLoaded||Chorus.Video.loadYoutubeApi(),this.init=function(){r.player=new YT.Player(e,{videoId:t.youtube_id||t.provider_video_id,playerVars:o,events:{onReady:o.onCreate,onStateChange:a},width:"100%",height:"100%"})},"undefined"!=typeof YT&&YT.Player?r.init():(YoutubeWrapper.initQueue.push(r),window.onYouTubeIframeAPIReady=function(){for(var e=0;e<YoutubeWrapper.initQueue.length;e++)YoutubeWrapper.initQueue[e].init()})}function EmbedWrapper(e,t,o){this.$el=jQuery("#"+e),this.elementId=e,this.meta=t,this.options=o=o||this.options;var a=t.provider_video_id;o.autoplay&&(a=Util.addQueryParam("autoplay","1",a));this.$el.html(a).find("iframe")}var PLAYGIF_DISABLE_FLAG;!function(e){e.fn.playGIF=function(t){var o=e.extend({on:"mouseenter",off:"mouseleave",autoResize:!1,enable:!0,circleBackgroundColor:"FFF200",circleTextColor:"4C4E4D",gifText:"GIF",removeAnchor:!0},t);"undefined"!=typeof PLAYGIF_DISABLE_FLAG&&(o.enable=!PLAYGIF_DISABLE_FLAG);var a=function(e,t,a){t=Math.floor(t),a=Math.floor(a);var r=35;e.fillStyle="#"+o.circleBackgroundColor,e.beginPath(),e.arc(t,a,r,0,2*Math.PI,!0),e.closePath(),e.fill(),e.fillStyle="#"+o.circleTextColor,e.font="15px 'Gotham SSm A', 'Gotham SSm B', sans-serif",e.textAlign="center",e.textBaseline="middle",e.fillText(o.gifText,t,a)};return this.each(function(){if(o.enable!==!1){var t=e(this);if(!t.is("img")||!/\.gif$/i.test(t.attr("src")))return!0;var r=document.createElement("canvas");if("undefined"==typeof r.getContext)return!0;var n=r.getContext("2d"),i=new Image,s=function(e,t){t.on(o.off,function(){u(e,t)});var a=t.attr("src");t.attr("src","data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),t.css({width:e.attr("width"),height:e.attr("height")}),setTimeout(function(){t.attr("src",a)},0),e.replaceWith(t)},u=function(e,t){e.on(o.on,function(){s(e,t)}),t.replaceWith(e)};i.onload=function(){var u=t.width(),l=t.height();r.width=u,r.height=l,n.drawImage(i,0,0,u,l);var c=e(r);if(o.autoResize===!0){r.setAttribute("data-src",t.attr("src")),r.setAttribute("class","gif");var d=e('<span class="faux-image">');d.css({"float":t.css("float"),margin:t.css("margin"),padding:t.css("padding"),"max-width":"100%",position:"relative",display:"block",height:r.height}),c.css({position:"absolute",top:0,left:0}),c=d.append(c)}else c.css({"float":t.css("float"),margin:t.css("margin"),padding:t.css("padding"),display:t.css("display")});t.replaceWith(c);var h=c.parent();h.is("p")||"none"===h.css("max-width")&&"none"===h.css("max-height")||(u=h.width(),l=h.height()),o.removeAnchor&&h.is("a")&&/\.gif$/i.test(h.attr("href"))&&h.replaceWith(c),u>150&&l>150&&a(n,u/2,l/2),c.on(o.on,function(){s(c,t)})},i.src=t.attr("src")}})}}(jQuery),/*
 * Lazy Load - jQuery plugin for lazy loading images
 *
 * Copyright (c) 2007-2012 Mika Tuupola
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 * Project home:
 *   http://www.appelsiini.net/projects/lazyload
 *
 * Version:  1.8.0.sbn
 * - Hacked so that it lazy loads non-IMG tags
 * - Hacked so that the scroll event that ends up firing lazyload:appear is debounced
 * - Hacked so resize event is debounced
 * - Hacked so data attributes are not cached via jQuery (neccesary for optimization)
 *
 */
function(e,t){var o=e(t);e.fn.lazyload=function(a){function r(e,t){return"undefined"!=typeof _?_.debounce(e,t):e}function n(){var t=0;s.each(function(){var o=e(this);if(!u.skip_invisible||o.is(":visible"))if(e.abovethetop(this,u)||e.leftofbegin(this,u));else if(e.belowthefold(this,u)||e.rightoffold(this,u)){if(++t>u.failure_limit)return!1}else o.trigger("lazyload:appear")})}var i,s=this,u={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:!0,appear:null,load:null,scrollInterval:200,resizeInterval:250};if(a&&(void 0!==a.failurelimit&&(a.failure_limit=a.failurelimit,delete a.failurelimit),void 0!==a.effectspeed&&(a.effect_speed=a.effectspeed,delete a.effectspeed),e.extend(u,a)),i=void 0===u.container||u.container===t?o:e(u.container),0===u.event.indexOf("scroll")){var l=function(e){return n()};i.bind(u.event,r(l,u.scrollInterval))}this.each(function(){var o=this,a=e(o);o.loaded=!1,o.error_event_set=!1;var n=4e3,i=4,l=0,c=function(){if(!this.loaded){if(u.appear){var r=s.length;u.appear.call(o,r,u)}if("IMG"===this.tagName)e("<img />").bind("load",function(){a.hide().attr("src",a.attr("data-"+u.data_attribute))[u.effect](u.effect_speed),o.loaded=!0;var t=e.grep(s,function(e){return!e.loaded});if(s=e(t),u.load){var r=s.length;u.load.call(o,r,u)}}).bind("error",function(){o.error_event_set||t.setTimeout(e.proxy(d,this),n),o.error_event_set=!0}).attr("src",a.attr("data-"+u.data_attribute));else{a.css("background-image","url('"+a.attr("data-"+u.data_attribute)+"')")[u.effect](u.effect_speed),o.loaded=!0;var i=e.grep(s,function(e){return!e.loaded});if(s=e(i),u.load){var r=s.length;u.load.call(o,r,u)}}}},d=function(){if(l+=1,i>=l){e(this).bind("error",function(){t.setTimeout(e.proxy(d,this),n)});var o=this.src.split("?")[0];this.src=o+"?"+(new Date).getTime()}};if(a.one("lazyload:appear",c),0!==u.event.indexOf("scroll")){var h=function(e){o.loaded||a.trigger("lazyload:appear")};a.bind(u.event,r(h,u.scrollInterval))}});var c=function(e){n()};return o.bind("resize",r(c,u.resizeInterval)),n(),this},e.belowthefold=function(a,r){var n;return n=void 0===r.container||r.container===t?o.height()+o.scrollTop():e(r.container).offset().top+e(r.container).height(),n<=e(a).offset().top-r.threshold},e.rightoffold=function(a,r){var n;return n=void 0===r.container||r.container===t?o.width()+o.scrollLeft():e(r.container).offset().left+e(r.container).width(),n<=e(a).offset().left-r.threshold},e.abovethetop=function(a,r){var n;return n=void 0===r.container||r.container===t?o.scrollTop():e(r.container).offset().top,n>=e(a).offset().top+r.threshold+e(a).height()},e.leftofbegin=function(a,r){var n;return n=void 0===r.container||r.container===t?o.scrollLeft():e(r.container).offset().left,n>=e(a).offset().left+r.threshold+e(a).width()},e.inviewport=function(t,o){return!(e.rightofscreen(t,o)||e.leftofscreen(t,o)||e.belowthefold(t,o)||e.abovethetop(t,o))},e.extend(e.expr[":"],{"below-the-fold":function(t){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return e.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!e.rightoffold(t,{threshold:0})},"in-viewport":function(t){return!e.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return e.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!e.rightoffold(t,{threshold:0})}})}(jQuery,window),function(e){e.fn.swipeEvents=function(){return this.each(function(){function t(e){var t=e.originalEvent.touches;t&&t.length&&(a=t[0].pageX,r=t[0].pageY,n.bind("touchmove",o)),e.preventDefault()}function o(e){var t=e.originalEvent.touches;if(t&&t.length){var i=a-t[0].pageX,s=r-t[0].pageY;i>=50&&n.trigger("swipeLeft"),-50>=i&&n.trigger("swipeRight"),s>=50&&n.trigger("swipeUp"),-50>=s&&n.trigger("swipeDown"),(Math.abs(i)>=50||Math.abs(s)>=50)&&n.unbind("touchmove",o)}e.preventDefault()}var a,r,n=e(this);n.bind("touchstart",t)})}}(jQuery),function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var o,a=e(document);e.rails=o={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not(form button), button[data-confirm]:not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",CSRFProtection:function(t){var o=e('meta[name="csrf-token"]').attr("content");o&&t.setRequestHeader("X-CSRF-Token",o)},refreshCSRFTokens:function(){var t=e("meta[name=csrf-token]").attr("content"),o=e("meta[name=csrf-param]").attr("content");e('form input[name="'+o+'"]').val(t)},fire:function(t,o,a){var r=e.Event(o);return t.trigger(r,a),r.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e[0].href},handleRemote:function(a){var r,n,i,s,u,l;if(o.fire(a,"ajax:before")){if(s=a.data("with-credentials")||null,u=a.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,a.is("form")){r=a.attr("method"),n=a.attr("action"),i=a.serializeArray();var c=a.data("ujs:submit-button");c&&(i.push(c),a.data("ujs:submit-button",null))}else a.is(o.inputChangeSelector)?(r=a.data("method"),n=a.data("url"),i=a.serialize(),a.data("params")&&(i=i+"&"+a.data("params"))):a.is(o.buttonClickSelector)?(r=a.data("method")||"get",n=a.data("url"),i=a.serialize(),a.data("params")&&(i=i+"&"+a.data("params"))):(r=a.data("method"),n=o.href(a),i=a.data("params")||null);return l={type:r||"GET",data:i,dataType:u,beforeSend:function(e,r){return r.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+r.accepts.script),o.fire(a,"ajax:beforeSend",[e,r])?void a.trigger("ajax:send",e):!1},success:function(e,t,o){a.trigger("ajax:success",[e,t,o])},complete:function(e,t){a.trigger("ajax:complete",[e,t])},error:function(e,t,o){a.trigger("ajax:error",[e,t,o])},crossDomain:o.isCrossDomain(n)},s&&(l.xhrFields={withCredentials:s}),n&&(l.url=n),o.ajax(l)}return!1},isCrossDomain:function(e){var t=document.createElement("a");t.href=location.href;var o=document.createElement("a");try{return o.href=e,o.href=o.href,!o.protocol||!o.host||t.protocol+"//"+t.host!=o.protocol+"//"+o.host}catch(a){return!0}},handleMethod:function(a){var r=o.href(a),n=a.data("method"),i=a.attr("target"),s=e("meta[name=csrf-token]").attr("content"),u=e("meta[name=csrf-param]").attr("content"),l=e('<form method="post" action="'+r+'"></form>'),c='<input name="_method" value="'+n+'" type="hidden" />';u===t||s===t||o.isCrossDomain(r)||(c+='<input name="'+u+'" value="'+s+'" type="hidden" />'),i&&l.attr("target",i),l.hide().append(c).appendTo("body"),l.submit()},formElements:function(t,o){return t.is("form")?e(t[0].elements).filter(o):t.find(o)},disableFormElements:function(t){o.formElements(t,o.disableSelector).each(function(){o.disableFormElement(e(this))})},disableFormElement:function(e){var o,a;o=e.is("button")?"html":"val",a=e.data("disable-with"),e.data("ujs:enable-with",e[o]()),a!==t&&e[o](a),e.prop("disabled",!0)},enableFormElements:function(t){o.formElements(t,o.enableSelector).each(function(){o.enableFormElement(e(this))})},enableFormElement:function(e){var t=e.is("button")?"html":"val";e.data("ujs:enable-with")&&e[t](e.data("ujs:enable-with")),e.prop("disabled",!1)},allowAction:function(e){var t,a=e.data("confirm"),r=!1;return a?(o.fire(e,"confirm")&&(r=o.confirm(a),t=o.fire(e,"confirm:complete",[r])),r&&t):!0},blankInputs:function(t,o,a){var r,n,i=e(),s=o||"input,textarea",u=t.find(s);return u.each(function(){if(r=e(this),n=r.is("input[type=checkbox],input[type=radio]")?r.is(":checked"):r.val(),!n==!a){if(r.is("input[type=radio]")&&u.filter('input[type=radio]:checked[name="'+r.attr("name")+'"]').length)return!0;i=i.add(r)}}),i.length?i:!1},nonBlankInputs:function(e,t){return o.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){var a=e.data("disable-with");e.data("ujs:enable-with",e.html()),a!==t&&e.html(a),e.bind("click.railsDisable",function(e){return o.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},o.fire(a,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,a){e.crossDomain||o.CSRFProtection(a)}),e(window).on("pageshow.rails",function(){e(e.rails.enableSelector).each(function(){var t=e(this);t.data("ujs:enable-with")&&e.rails.enableFormElement(t)}),e(e.rails.linkDisableSelector).each(function(){var t=e(this);t.data("ujs:enable-with")&&e.rails.enableElement(t)})}),a.delegate(o.linkDisableSelector,"ajax:complete",function(){o.enableElement(e(this))}),a.delegate(o.buttonDisableSelector,"ajax:complete",function(){o.enableFormElement(e(this))}),a.delegate(o.linkClickSelector,"click.rails",function(a){var r=e(this),n=r.data("method"),i=r.data("params"),s=a.metaKey||a.ctrlKey;if(!o.allowAction(r))return o.stopEverything(a);if(!s&&r.is(o.linkDisableSelector)&&o.disableElement(r),r.data("remote")!==t){if(s&&(!n||"GET"===n)&&!i)return!0;var u=o.handleRemote(r);return u===!1?o.enableElement(r):u.fail(function(){o.enableElement(r)}),!1}return n?(o.handleMethod(r),!1):void 0}),a.delegate(o.buttonClickSelector,"click.rails",function(t){var a=e(this);if(!o.allowAction(a))return o.stopEverything(t);a.is(o.buttonDisableSelector)&&o.disableFormElement(a);var r=o.handleRemote(a);return r===!1?o.enableFormElement(a):r.fail(function(){o.enableFormElement(a)}),!1}),a.delegate(o.inputChangeSelector,"change.rails",function(t){var a=e(this);return o.allowAction(a)?(o.handleRemote(a),!1):o.stopEverything(t)}),a.delegate(o.formSubmitSelector,"submit.rails",function(a){var r,n,i=e(this),s=i.data("remote")!==t;if(!o.allowAction(i))return o.stopEverything(a);if(i.attr("novalidate")==t&&(r=o.blankInputs(i,o.requiredInputSelector),r&&o.fire(i,"ajax:aborted:required",[r])))return o.stopEverything(a);if(s){if(n=o.nonBlankInputs(i,o.fileInputSelector)){setTimeout(function(){o.disableFormElements(i)},13);var u=o.fire(i,"ajax:aborted:file",[n]);return u||setTimeout(function(){o.enableFormElements(i)},13),u}return o.handleRemote(i),!1}setTimeout(function(){o.disableFormElements(i)},13)}),a.delegate(o.formInputClickSelector,"click.rails",function(t){var a=e(this);if(!o.allowAction(a))return o.stopEverything(t);var r=a.attr("name"),n=r?{name:r,value:a.val()}:null;a.closest("form").data("ujs:submit-button",n)}),a.delegate(o.formSubmitSelector,"ajax:send.rails",function(t){this==t.target&&o.disableFormElements(e(this))}),a.delegate(o.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&o.enableFormElements(e(this))}),e(function(){o.refreshCSRFTokens()}))}(jQuery);var SBN=SBN||{};SBN.Nav=function(e){function t(){var t=e(".m-site-nav__logo img"),o=t.attr("data-logo-url");t.attr("src",o)}function o(t,o,a){var n=e(".m-site-nav__logo img"),i=n.attr("data-dark-logo-url"),s=n.attr("data-light-logo-url");if(r(),_.delay(r,1e3),i&&s&&(n.attr("src",t?s:i),o)){var u=n.attr("data-bw-logo-url");u?n.attr("src",u):console.log("Tried to apply third logo/black and white logo, but none was available for this site/network.")}}function a(t,o){if(!S){t.children("li").css({visibility:"hidden"}).removeClass("is-hidden-desktop");var a=t.find(".m-site-nav__more-link"),r=a.find("ul").empty(),n=o-a.width()-E,i=0,s=0;t.children(".is-pinned").css("visibility","visible").each(function(){i+=e(this).width()}),t.children("li").not(".is-pinned").each(function(){var t=e(this);if(!t.is(a))if(i+=t.width(),n>i)t.css("visibility","visible");else{s++;var o=t.children("a");o.length>0&&r.append("<li>"+o[0].outerHTML+"</li>"),t.addClass("is-hidden-desktop"),t.css("visibility","visible")}}),s>0&&a.css("visibility","visible")}}function r(){if(Chorus.Environment.currentBreakpoint().index>1){var t=x.width()-T.width();x.find(".m-site-nav__network, .m-site-nav__community").each(function(){a(e(this),t)})}else x.find("> ul > li").css({visibility:"visible"})}function n(){k.toggleClass("is-mobile-nav-active")}function i(){clearTimeout(A),Chorus.Environment.currentBreakpoint().index>1&&k.hasClass("has-both-navs")===!0&&k.addClass("is-network-nav-active")}function s(){k.removeClass("is-network-nav-active"),clearTimeout(A)}function u(e){o(e.useLightLogo===!0,e.useThirdLogo===!0,e.useSolidBackground===!0)}function l(e){Chorus.Environment.currentBreakpoint().index>1&&e.toggleClass("is-active")}function c(e){Chorus.Environment.currentBreakpoint().index<2&&e.hasClass("has-dropdown")&&(x.find(".is-active").not(e).removeClass("is-active"),e.toggleClass("is-active"))}function d(t){l(e(t.currentTarget))}function h(t){var o=e(t.currentTarget);o.hasClass("has-dropdown")===!0&&o.hasClass("is-active")===!1&&t.preventDefault(),c(o)}function f(e){r()}function p(e){i()}function m(e){A=setTimeout(s,2e3)}function g(e){s()}function v(t){e(".m-site-nav__search").addClass("is-focus")}function y(t){e(".m-site-nav__search").removeClass("is-focus")}function b(e){n()}function C(t){var o=e(t.currentTarget);o.find("iframe").css({"background-color":o.css("background-color")}),FB.XFBML.parse(document.getElementById("nav-fb-like-btn"))}function w(){k=e(".m-site-nav"),x=k.find("nav"),t(),T=e(".m-site-nav__right-side"),e(".m-site-nav nav > ul > li").on("mouseenter",d).on("mouseleave",d),e(".m-site-nav nav .m-site-nav__community > li").on("click",h),Chorus.EventDispatcher.subscribe("campaignReskinApplied",u),e(window).on("resize",_.debounce(f,100)),e(".m-site-nav__netnav-trigger, .m-site-nav__network").on("mouseenter",p),x.on("mouseleave",m),e(".m-site-nav__logo").on("mouseenter",g),e(".m-site-nav__search__input").on("focus",v).on("blur",y),e(".m-site-nav__mobile-trigger").on("click",b),e(".m-site-nav__social-btn").on("mouseenter",C),r()}var A,k,x,T,S=e.browser.msie&&e.browser.version<9,E=10;return{init:function(){w()}}}(jQuery),jQuery(function(){SBN.Nav.init()});var SBN=SBN||{};SBN.DelayedLoadGlobalNav=function(e){return{init:function(){var t=e("#delayedLoadGlobalNavSubItems");t.find(".m-site-nav__dropdown").each(function(t,o){var a=e(o);e("#"+a.data("nav-id")).append(a)}),t.remove()}}}(jQuery);var SBN=SBN||{};SBN.UserNav=function(e){return{init:function(e){this.config(function(){SBN.UserNav.mySbnToggle.off("click",SBN.UserNav.showMySbnModal),SBN.UserNav.mySbnToggle.on("click",SBN.UserNav.showMySbnModal)})},config:function(t){this.mySbnToggle=e("#user-nav-my-sbn"),t()},showMySbnModal:function(e){Chorus.EventDispatcher.publish("modal_open",{url:"/modal/mysbn"}),e.preventDefault()}}}(jQuery),jQuery(function(){SBN.UserNav.init()}),function(e){function t(e){var t={};e=(e||"").replace(/^(\?|\&)/,"").split("&");for(var o=0;o<e.length;o++){var a=e[o].split("=");a.length>1&&(t[a[0]]=a[1])}return t}function o(o,a){var n=o.attr("href"),i=o.attr("data-url");if(i&&r[a]&&(n=r[a]+encodeURIComponent(i)),n&&"#"!==n[0]){var s=n.match(/(.*(?:\?|\&)(?:url|u)=)([^&]+)(.*)/),u=o.closest("[data-analytics-placement]").attr("data-analytics-placement"),l=decodeURIComponent(s[2]).split("?"),c=l[0].split("#"),d=c[0]||l[0],h=c[1]||"",f=e.extend({utm_campaign:location.hostname.replace(/(www\.)?(.+)\.com/,"$2"),utm_content:Chorus.Analytics.contentType()+(u?":"+u:""),utm_medium:"social",utm_source:a},t(l[1]),t(o.attr("data-params")));n=""==h.trim()?s[1]+encodeURIComponent(d+"?"+e.param(f))+s[3]:s[1]+encodeURIComponent(d+"?"+e.param(f)+"#"+h)+s[3],o.attr("href",n)}return n}var a,r={facebook:"http://www.facebook.com/share.php?u=",twitter:"https://twitter.com/intent/tweet?url=",pinterest:"https://www.pinterest.com/pin/create/button/?url="};e("[data-analytics-social]").on("click",function(t){var r,n,i=e(this),s=i.attr("data-analytics-social"),u=o(i,s),l=570,c=570;if(Chorus.Context.is_preview)return t.stopPropagation(),alert("Social buttons cannot be used during preview.");switch(s){case"facebook":c=279;break;case"twitter":c=279;break;case"linkedin":c=520;break;case"pinterest":l=c=750}if("#"!==u[0]&&"_blank"!==i.attr("target")&&"whatsapp"!==s){a&&a.close&&a.close(),n=screen.width/2-l/2,r=screen.height/2-c/2,a=window.open(u,"","width="+l+", height="+c+", top="+r+", left="+n),t.preventDefault();var d=window.open;window.open=function(){},setTimeout(function(){window.open=d},0)}}),function(e,t,o){function a(){var e,a=t.getElementsByTagName(o)[0],r=function(r,n){t.getElementById(n)||(e=t.createElement(o),e.src=r,e.id=n,a.parentNode.insertBefore(e,a))};Util.UserAgentProfiler.isAndroidLt3()||(r("https://connect.facebook.net/en_US/all.js#xfbml=1","fbjs"),r("https://platform.twitter.com/widgets.js","tweetjs"))}e.addEventListener?e.addEventListener("load",a,!1):e.attachEvent&&e.attachEvent("onload",a)}(window,document,"script"),function(){function t(){c();var e=l,t=a.scrollTop(),r=t>=i,n=!s||s>=t;l=r&&n&&!u,l!==e&&(Chorus.EventDispatcher.publish("fixedSocial",{isFixed:l,position:o.position()}),o.toggleClass("fixed",l))}var o=e("#chorus-social-fixed");if(o.length){o.appendTo("body");var a=e(window),r=e("#chorus-social-fixed-threshold"),n=e("#comments"),i=0,s=0,u=!1,l=!1,c=_.throttle(function(){Chorus.Environment.touch()&&(u=screen.width>window.innerWidth),r.length&&(i=r.offset().top),n.length&&(s=n.offset().top)},1500);e(document).on("scroll",_.throttle(t,150)),t()}}(),e("[data-shareable-content]").each(function(){var t=e(this),o=t.attr("data-original")||t.attr("src");if(!o){var a=this.currentStyle||window.getComputedStyle(this,!1);o=a&&a.backgroundImage.slice(4,-1)}if(o){var n="m-shareable-content",i=n+"__wrap",s=r.pinterest+encodeURIComponent(location.href)+"&media="+encodeURIComponent(o),u=Chorus.Environment.touch()?" touch":"";if(t.is("img")){var l=t.closest("."+i);t=l.length?l:t.wrap('<div class="'+i+'"></div>').parent()}else t.toggleClass(i,!0);t.prepend('<a href="'+s+'" class="'+n+"__pinterest"+u+'" data-analytics-social="pinterest"></a>')}})}(jQuery);var Chorus=Chorus||{};Chorus.DynamicSizedImages=function(e){function t(t,o){var s={failure_limit:20,load:function(){var t=e(this),o=t.parent(".image-window");if(t.is("img")&&(o.length>0?(t.css({position:"absolute",top:Math.round((o.outerHeight()-t.outerHeight())/2),left:Math.round((o.outerWidth()-t.outerWidth())/2)}),"undefined"==typeof t.attr("height")&&t.css("height","auto")):"undefined"==typeof t.attr("height")&&t.css("height","auto")),t.addClass(n),t.removeClass(i),t.removeClass("m-chorus-asset__in-entry-body"),e.fn.playGIF){var a=Chorus.Context.gif_opts||{},r={on:"touchstart",off:"touchstart"};if(Chorus.Context&&Chorus.Context.main_link_color&&(a.circleBackgroundColor=Chorus.Context.main_link_color,a.circleTextColor="FFFFFF"),"undefined"==typeof PLAYGIF_DISABLE_FLAG){var s=e('.m-entry__body img[src*=".gif"], .m-entry__body img[data-original*=".gif"], .m-block__fanshot-media img[src*=".gif"]'),u=e('.m-entry__top-hero .m-entry__photo img[data-original*=".gif"]');s.length+u.length===1?PLAYGIF_DISABLE_FLAG=!0:s&&s.length>0&&(PLAYGIF_DISABLE_FLAG=!1,Modernizr.touch?s.playGIF(r):s.playGIF(a))}Modernizr.touch?t.playGIF(r):t.playGIF(a)}},threshold:800};o&&e.extend(s,o),t=e("undefined"!=typeof t&&null!==t?t:"body");var u=t.find(r+":visible").not("."+i+", ."+n),l=[],c=[];u.each(function(){var t,o,r,n,u,d=e(this),h=d.attr("data-imgkey"),f=d.data("chorus-asset-id");if("undefined"!=typeof h){if(s.parentDimensionSlc){var p=d.closest(s.parentDimensionSlc);t=p.outerWidth(),o=p.outerHeight()}t||(t=d.outerWidth()),o||(o=d.outerHeight()),0==o&&(r=d.data("ratio"),o="undefined"!=typeof r&&r>0?Math.ceil(t/r):t),d.is("img")&&(r=d.data("ratio"),n=d.parent(".image-window"),"undefined"!=typeof r&&r>0&&(o=Math.ceil(t/r)),n.length>0&&(t=Math.ceil(n.outerWidth()),o=Math.ceil(n.outerHeight())),o>0&&d.css("height",o)),"undefined"!=typeof window.devicePixelRatio&&(t=Math.ceil(t*window.devicePixelRatio),o=Math.ceil(o*window.devicePixelRatio)),Chorus.Context&&"racked"===Chorus.Context.network_slug&&(t=Math.ceil(1.3*t),o=Math.ceil(1.3*o)),/\.(png|jpg|jpeg)$/i.test(d.attr("data-original"))&&a.webp&&!Chorus.Modernizr.touch&&(u="webp");var m=h+":"+t+"x"+o+(u?":"+u:"");l.push(m),d.attr("data-dim",t+"x"+o),d.addClass(i)}else if("undefined"!=typeof f){t=d.outerWidth(),o=d.outerHeight(),d.is("img")&&(r=d.data("ratio"),n=d.parent(".image-window"),"undefined"!=typeof r&&r>0&&(o=Math.ceil(t/r)),n.length>0&&(t=Math.ceil(n.outerWidth()),o=Math.ceil(n.outerHeight())),o>0&&d.css("height",o)),"undefined"!=typeof window.devicePixelRatio&&(t=Math.ceil(t*window.devicePixelRatio),o=Math.ceil(o*window.devicePixelRatio)),"racked"===Chorus.Context.network_slug&&(t=Math.ceil(1.3*t),o=Math.ceil(1.3*o));var g=f+":"+t+":"+o;c.push(g),d.data("asset-key",g),d.addClass(i)}else d.lazyload(s)}),(0!==l.length||0!==c.length)&&(e.each([c,l],function(e,t){t.sort(function(e,t){return+e.split(":")[0]-+t.split(":")[0]})}),e.ajax({type:"GET",url:"/chorus_page/optimally_sized_images",dataType:"json",contentType:"application/json",timeout:1e4,data:{imgkeys:l.join(","),asset_keys:c.join(",")},success:function(t){var o=t.urls,a={};_.forEach(o,function(e,t){var o=t.replace(/\:webp|\:jp2/,"");a[o]=e}),o=a,u.each(function(){var t,a=e(this);t=a.attr("data-imgkey")?a.attr("data-imgkey")+":"+a.attr("data-dim"):a.data("asset-key");var r=o[t];"undefined"!=typeof r&&(a.attr("data-original",r),a.lazyload(s))})}}))}e(document).ready(function(){Chorus.DynamicSizedImages.init(),Chorus.EventDispatcher&&Chorus.EventDispatcher.publish("dynamic-images-available",{},!0)});var o={},a={webp:!1,jp2:!1},r=".vox-lazy-load",n="lazy-loaded",i="lazy-loading";return o.init=function(){function e(){if(Chorus.Modernizr.localstorage&&window.localStorage.getItem("supportsWebp"))a.webp="true"===window.localStorage.getItem("supportsWebp")?!0:!1,r();else{var e=new Image;e.onload=function(){a.webp=!!(e.height>0&&e.width>0),Chorus.Modernizr.localstorage&&window.localStorage.setItem("supportsWebp",a.webp),r()},e.onerror=function(){a.webp=!1,Chorus.Modernizr.localstorage&&window.localStorage.setItem("supportsWebp",a.webp),r()},e.src="data:image/webp;base64,UklGRiYAAABXRUJQVlA4IBoAAAAwAQCdASoBAAEAAIAOJaQAA3AA/v89WAAAAA=="}}function r(){Chorus&&Chorus.Context&&Chorus.Context.defer_image_loading?Chorus.Context.defer_image_loading=!1:o.initUI(),Chorus.EventDispatcher&&Chorus.EventDispatcher.subscribe("moduleInserted",function(e){t(e.modules)})}e()},o.initUI=function(e,o){t(e,o)},o.applyTo=function(e,o){t(e,o)},o}(jQuery);var SBN=SBN||{};SBN.EmcAdmin=function(e){function t(t,o){var a=t.find("input"),r=o.find("input");a.each(function(t){var o=e(this),a=e(r[t]),n=a.val();a.val(o.val()),o.val(n)})}function o(o){var a=e(o.currentTarget).closest("li"),r=a.prev("li");t(a,r)}function a(o){var a=e(o.currentTarget).closest("li"),r=a.next("li");t(a,r)}return{init:function(t){0!=Chorus.Context.emc_admin&&($doc=e(document),$doc.on("click",".m-emc-admin__reorderable-list .up",o),$doc.on("click",".m-emc-admin__reorderable-list .down",a))}}}(jQuery),jQuery(function(){SBN.EmcAdmin.init()});var SBN=SBN||{};SBN.FighterMediaCarousel=function(e){function t(t,o){var a=t.data("carousel-current-pane")||0,r=t.data("carousel-panes-count"),n=t.find(".m-mmaf-pte-media__carousel-inner");a=o===!0?a-1:a+1,0>a?a=r-1:a>=r&&(a=0),t.find(".m-mmaf-pte-media__carousel-item").css({left:0-a*n.width()+"px"}),t.data("carousel-current-pane",a),_.delay(e(window).trigger("resize"),1e3)}function o(o){o.stopPropagation(),t(e(o.currentTarget).closest(".m-mmaf-pte-media__carousel"),o.data.back)}return{init:function(){var t=e(".m-mmaf-pte-media__carousel");t.length>0&&t.each(function(){var t=0,a=e(this),r=a.find(".m-mmaf-pte-media__carousel-inner");if(r.children().each(function(){t=t+e(this).width()-4}),t>a.width())if(a.data("carousel-panes-count",Math.ceil(t/r.width())),Chorus.Environment.touch()===!0)r.swipeEvents(),r.on("swipeLeft",{back:!0},o),r.bind("swipeRight",{back:!1},o);else{a.addClass("has-controls");var n=e('<div class="m-mmaf-pte-media__carousel-back">&lang;</div>').css({lineHeight:a.height()-40+"px"});n.on("click",{back:!0},o),a.append(n);var i=e('<div class="m-mmaf-pte-media__carousel-next">&rang;</div>').css({lineHeight:a.height()-40+"px"});i.on("click",{back:!1},o),a.append(i)}})}}}(jQuery),jQuery(function(){SBN.FighterMediaCarousel.init()});var SBN=SBN||{};SBN.FighterIndex=function(e){function t(t){o(),e("a.is-selected").removeClass("is-selected"),e(".m-mmaf-pte-fighter-index__head").remove(),e('a[data-fighter-letter="'+t+'"]').addClass("is-selected"),e.post("/fighters",{letter:t},n)}function o(){var t=e(".m-mmaf-pte-fighter-index__items");t.css("min-height",t.height()),t.html('<li class="loading"><span class="msg">Loading...</span></li>')}function a(t){for(var o=[],a=t.length-1;a>0;a--){var r=t[a].data;o.unshift('<li><a href="/fighter/'+r.id+"/"+r.slug+'">'+r.name+"</a></li>")}e(".m-mmaf-pte-fighter-index__items").html(o.join(""))}function r(o){t(e(o.currentTarget).data("fighter-letter"))}function n(e){a(e)}return{init:function(){e(".m-mmaf-pte-fighter-index").length<1||e("a[data-fighter-letter]").on("click",r)}}}(jQuery),jQuery(SBN.FighterIndex.init);var Chorus=Chorus||{};Chorus.EditoriallyManagedCell=function(e,t){"use strict";function o(e){for(var t={},o=e.serializeArray(),a=o.length-1;a>-1;a--){var r=o[a].name,n=o[a].value;t[r]?t[r]=_.flatten([t[r],n]):t[r]=n}return t}function a(e){alert("There was an error updating this cell. Please check your URL and/or that all fields are completed.")}function r(t){t.preventDefault();var o=e(t.currentTarget);i(o.closest(".chorus-emc__admin"),o.data("emc-action"),o.data("emc-data"))}function n(t){t.preventDefault();var a=e(t.currentTarget),r=a.closest("form");i(e('.chorus-emc__admin[data-emc-slug="'+r.data("emc-slug")+'"]'),"update",_.extend(o(r),{button_action:a.data("emc-action")}))}function i(t,o,r){var r=_.extend({slug:t.data("emc-slug"),bucket:t.data("emc-bucket")},r),n=l[o];if("edit"===o||"help"===o)Chorus.EventDispatcher.publish("modal_open",{method:i,url:n,data:r});else{var i="update"==o?"POST":"GET";s(t),e.ajax({method:i,url:n,data:r,success:function(o){Chorus.EventDispatcher.publish("modal_close");var a=e('.chorus-emc__content[data-emc-slug="'+t.data("emc-slug")+'"]');a.length>0&&a.replaceWith(o)},error:a})}}function s(t){e(t).find(".chorus-emc__content").html("Loading...")}function u(){e(t).on("click",".chorus-emc__admin *[data-emc-action]",r),e(t).on("click",".chorus-emc__form *[data-emc-action]",n)}var l={edit:"/editorially_managed_cells/handle_edit",update:"/editorially_managed_cells/handle_update",preview:"/editorially_managed_cells/preview",show_live:"/editorially_managed_cells/refresh",help:"/editorially_managed_cells/help"};return{init:u,urls:l}}(jQuery,document),jQuery(function(){Chorus.EditoriallyManagedCell.init()}),jQuery(function(){function e(e){if(e.videoId){var t="ooyala"===Chorus.VideoContext.getVideoById(e.videoId).provider_video_type;return Chorus.VideoContext.createPlayer(h,e.placement,{autoplay:t})}if(e.embedCode){var o=e.embedCode;return o=o.replace("&lt;","<"),o=o.replace("&gt;",">"),o=A(o).attr("width","100%").attr("height","100%").each(function(){var e=A(this);src=e.attr("src"),src+=src.indexOf("?")>-1?"&":"?",src=src.replace(/autoplay=\d/g,"")+"autoplay=1&",src=src.replace(/ap=false/g,"")+"ap=true",src=src.replace(/width=\d+/g,""),src=src.replace(/height=\d+/g,""),e.css({"background-color":"#222"}),e.attr("src",src)}),A("#"+h).html(o).closest(d).addClass(y)}setTimeout(function(){window.location.href=e.url},100)}function t(e){A(g).removeClass(v),e.addClass(v);var t=A(p);t.animate({scrollTop:t.scrollTop()+e.parent().position().top},{duration:500})}function o(e){var t={videoId:e.data("video-chorus-id")||null,placement:e.data("placement")},o=(e.parent().find("script").html()||"").match(/["'](embed-.+?)['"]/);return o&&(t.videoId=o[1]),e.data(C)&&(t.embedCode=e.data(C)),t.url=e.attr("href"),t}function a(e,t){function o(){e.siblings(".up")[0==e.scrollTop()?"removeClass":"addClass"]("is-active")}var a=e.scrollTop();t===!0?a-=e.height():a+=e.height(),e.animate({scrollTop:a},{duration:500,complete:o})}function r(t){t.preventDefault(),e(o(A(t.currentTarget)))}function n(a){a.preventDefault();var r=A(a.currentTarget);t(r),e(o(r))}function i(e){e.preventDefault(),A(e.currentTarget).siblings("a").trigger("click")}function s(e){e.stopPropagation(),e.preventDefault(),a(e.data.playlist,!0)}function u(e){e.stopPropagation(),e.preventDefault(),a(e.data.playlist,!1)}function l(){Chorus.Analytics.onElementView(k,function(){var e=k.find("a[data-placement]").map(function(){return this.getAttribute("data-placement")});Chorus.VideoContext.trackPlacementsInViewport(e)})}function c(){x.on("click",f,r),x.on("click","h3",i),A(g).on("click",n),t(A(g+"[data-"+b+'="'+x.find(f).data(b)+'"]')),A(p).each(function(){var e=A(this),t=e.find(m),o=t.height();if(o*t.length>e.height()){var a=A('<div class="'+w+'"><span>&#xF500;</span></div>').on("click",{playlist:e},s),r=A('<div class="'+_+'"><span>&#xF501;</span></div>').on("click",{playlist:e},u);e.after(a).after(r)}}),l()}var d=".m-video-browser",h="video-browser",f="a",p=".m-video-browser__playlist",m=".m-video-browser__item",g=".m-video-browser__item a",v="is-selected",y="is-playing",b="video-title",C="video-embed-code",w="m-video-browser__playlist_btn up",_="m-video-browser__playlist_btn is-active down",A=jQuery,k=A(d),x=k.find(".m-video-browser__player");k.length&&c()});var Chorus=Chorus||{};Chorus.Modal=function(e){"use strict";function t(){if(null===C){var t=e(b());v.append(t),t.on("click",p),C=t.find(".m-chorus-modal__root").addBack(".m-chorus-modal__root").first()}}function o(){t(),v.addClass("chorus-modal-loading")}function a(){v.removeClass("chorus-modal-loading")}function r(){t(),v.addClass("chorus-modal-open")}function n(){v.removeClass("chorus-modal-open")}function i(t){o();t.data||{};t.success=function(e){t.content=e,s(t)},t.error=function(e,t){"abort"!==t&&alert("There was an error recieving data from the server."),a()},w.push(e.ajax(t))}function s(t){a(),r();var o=e(y(t));o.find(".m-chorus-modal__window-root").append(t.content),o.addClass(t.modalClass),o.data("chorus-modal-callbacks",t.callbacks),C.prepend(o),o.on("click","*[data-chorus-modal-action]",f),c("attach",o)}function u(e){e.remove(),0===C.children().length&&(n(),a())}function l(e){e.callbacks=e.callbacks||{},e.title=e.title||"Untitled Modal",e.content=e.content||null,e.modalClass=e.modalClass||null,e.url?i(e):null!==e.content&&s(e)}function c(e,t){var o=t.data("chorus-modal-callbacks");if("cancel_confirm"===e){if(!confirm("Are you sure you want to close this window?"))return;e="cancel"}"function"==typeof o[e]&&o[e](t),("cancel"==e||"close"==e)&&u(t)}function d(){for(Chorus.EventDispatcher.publish("modal_closed_by_modaljs"),e(".m-chorus-modal__window").each(function(){c("cancel",e(this))}),null!==C&&C.empty(),n(),a();w.length>0;)w.pop().abort()}function h(){A=!0;var t=e("#chorus-modal-window-template").html()||"",o=e("#chorus-modal-wrapper-template").html()||"";v=e("body"),y=_.template(t),b=_.template(o)}function f(t){t.preventDefault(),c(e(t.target).data("chorus-modal-action").toString().trim(),e(t.delegateTarget))}function p(t){e(t.target).is(C)&&d()}function m(e){A===!1&&h(),l(e)}function g(e){d()}var v,y,b,C=null,w=[],A=!1;return{init:function(){Chorus.EventDispatcher.subscribe("modal_open",m),Chorus.EventDispatcher.subscribe("modal_close",g)},open:function(e){Chorus.EventDispatcher.publish("modal_open",e)},close:function(e){Chorus.EventDispatcher.publish("modal_close",e)}}}(jQuery),Chorus.Modal.init();var Chorus=Chorus||{};Chorus.RemoteEntryAdminPermissions=function(e){"use strict";function t(){var t=e(s).map(function(t,o){return e(o).data(n)});t=_.uniq(_.compact(t)).sort(),t.length&&e.ajax({method:"GET",url:i,dataType:"json",data:{entry_ids:t.join(":")},success:o,
error:a})}function o(e){r=_.extend(r,{loaded:!0},e),Chorus.EventDispatcher.publish("permissionsLoaded",_.clone(r),!0)}function a(){console&&console.error("there was an error loading the permissions object from the client controls")}var r={loaded:!1},n="remote-admin-entry-id",i="/remote_entry_admin/check_permissions",s="*[data-"+n+"]";return{init:function(){Chorus.Context.logged_in!==!1&&t()},getPermissions:function(){return r}}}(jQuery),jQuery(Chorus.RemoteEntryAdminPermissions.init);var Chorus=Chorus||{};Chorus.EntryAdminControls=function(e){"use strict";function t(t){e(m).each(function(o,a){var r=e(a),n=r.data(f),i=t[n];if(i&&i.permitted===!0){var s=r.data(p);"button"===s&&(r.append(b(i)),r.on("click",u)),"pane"===s&&r.load(g,{entry_id:n},function(){r.on("mouseenter",l),r.on("mouseleave",c)})}}),e("body").on("click","#inspect-images-link",d),e("body").on("click","#hide-entry-link",h)}function o(e){Chorus.EventDispatcher.publish("modal_open",{url:v,data:{entry_id:e}})}function a(e){return"*[data-"+f+'="'+e+'"][data-'+p+'="pane"]'}function r(t){e(a(t)).addClass("is-active")}function n(t){e(a(t)).removeClass("is-active")}function i(t){var o="Hidden"===t.text();t.text(o?"Unhiding":"Hiding"),e.ajax({method:"POST",url:t.attr("href"),dataType:"text",complete:function(){location.reload(!0)}})}function s(e){t(e)}function u(t){if(Util.UserAgentProfiler.isMobile()===!1){var r=e(t.delegateTarget).data(f);e(a(r)).length<1&&(t.preventDefault(),o(r))}}function l(t){r(e(t.delegateTarget).data(f))}function c(t){n(e(t.delegateTarget).data(f))}function d(t){t.preventDefault(),Chorus.EventDispatcher.publish("modal_open",{url:y+"/"+e(t.target).data(f)})}function h(t){var o=confirm("Are you sure?");return o?(t.preventDefault(),void i(e(t.target))):!1}var f="remote-admin-entry-id",p="remote-admin-entry-type",m="*[data-"+p+"]",g="/remote_entry_admin/pane",v="/remote_entry_admin/actions_modal",y="/remote_entry_admin/image_sizes_modal",b=_.template('<a href="[%= data.edit_url%]">Edit Entry</a>');return{init:function(){Chorus.Context.logged_in!==!1&&Chorus.EventDispatcher.subscribe("permissionsLoaded",s)}}}(jQuery),jQuery(Chorus.EntryAdminControls.init);var Chorus=Chorus||{};Chorus.RemoteHeadlineEdit=function(e){"use strict";function t(t){var o=t.data("remote-headline-promo-headine"),a=e(b({current_headline:t.text(),headline_save_url:v,field:t.data(m),entry_id:t.data(p),include_buttons:o?!1:!0}));if(t.after(a),t.addClass("is-editing"),a.on("change",'input[type="text"]',h),a.on("click",'input[type="submit"]',d),a.on("click",'input[value="cancel"]',c),a.on("submit",function(e){e.preventDefault()}),o){var r=e(b({current_headline:o,headline_save_url:v,field:g,entry_id:t.data(p),include_buttons:!0}));a.after(r),r.on("change",'input[type="text"]',h),r.on("click",'input[type="submit"]',d),r.on("click",'input[value="cancel"]',c),r.on("submit",function(e){e.preventDefault()})}}function o(t,o){return o===g&&(o="title"),e("*[data-"+m+'="'+o+'"][data-'+p+'="'+t+'"]')}function a(e){o(e.data(p),e.data(m)).removeClass("is-editing"),e.siblings(".m-inline-headline-edit__form").remove(),e.remove()}function r(e){e.find('input[type="text"], input[type="submit"]').prop("disabled",!0)}function n(e){e.find('input[type="text"], input[type="submit"]').prop("disabled",!1)}function i(e){e.data("remote-headline-edit-submit",!0)}function s(t){t.add(t.siblings(".m-inline-headline-edit__form")).each(function(t,i){var s=e(i);if(s.data("remote-headline-edit-submit")===!0){var u=s.find('input[name="entry_id"]').val(),l=s.find('input[name="new_value"]').val(),c=s.find('input[name="field"]').val();r(s),e.ajax({method:"POST",url:v,dataType:"json",data:{entry_id:u,field:c,value:l},success:function(e){c===g?o(u,"title").data("remote-headline-promo-headine",l):o(u,c).text(l),a(s),alert(Util.stringToTitleCase(c.replace(/_/g," "))+" saved!")},error:function(e,t){n(s),alert("There was an error recieving data from the server.")}})}})}function u(t){e("*[data-"+m+"]").each(function(o,a){var r=e(a),n=t[r.data(p)];n&&n.permitted===!0&&(r.addClass("is-editable"),r.on("click",l))})}function l(o){o.preventDefault();var a=e(o.delegateTarget);a.hasClass("is-editing")===!1&&t(a)}function c(t){t.preventDefault(),a(e(t.delegateTarget))}function d(t){t.preventDefault(),s(e(t.delegateTarget))}function h(t){i(e(t.delegateTarget))}function f(e){e.is_headline_editor===!0&&u(e)}var p="remote-admin-entry-id",m="remote-headline-edit",g="promo_headline_field",v="/remote_entry_admin/update_title",y=['<form action="[%= data.headline_save_url %]" data-'+p+'="[%= data.entry_id %]" data-'+m+'= "[%= data.field %]" method="post" class="m-inline-headline-edit__form">','<label for="new_value">[%= data.field.replace(/_/g, " ")  %]</label>','<input type="text" name="new_value" value="[%= data.current_headline %]" />','<input type="hidden" name="entry_id" value="[%= data.entry_id %]" />','<input type="hidden" name="field" value="[%= data.field %]" />','[% if (data.include_buttons === true) { %]<input type="submit" value="Save" class="p-button"/>','<input type="button" value="cancel" class="p-button" /> [% } %]',"</form>"].join(""),b=_.template(y);return{init:function(){Chorus.Context.logged_in!==!1&&Util.UserAgentProfiler.isMobile()!==!0&&Chorus.EventDispatcher.subscribe("permissionsLoaded",f)}}}(jQuery),jQuery(Chorus.RemoteHeadlineEdit.init);var Chorus=Chorus||{};Chorus.HubAdminMenu=function(e){"use strict";function t(){a.on("click",function(){a.toggleClass("is-open")}),o()}function o(){a.on("mouseenter",function(){if(!r){r=!0;var t=a.find(".m-quick_admin__pageviews");if(0!==t.length){var o=t.find(".m-quick_admin__pageviews-count"),n=window.location.hostname+window.location.pathname;e.ajax({method:"GET",dataType:"json",url:"http://providence.voxmedia.com/api/count.json",data:{event_name:"page_view",location:n},success:function(e){o.html(Number(e.count).toLocaleString()+" "+o.html()),t.show()}})}}})}var a=e("#hub-admin-menu"),r=!1;return{init:function(){t()}}}(jQuery),jQuery(Chorus.HubAdminMenu.init);var Util=Util||{};Util.UserAgentProfiler=function(){var e="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||navigator.msMaxTouchPoints>0,t=window.innerWidth,o=window.navigator.userAgent,a=e&&728>t||window.location.href.indexOf("mobile=true")>0,r=e&&t>=728,n=!a&&!r,i=/(iPad|iPhone|iPod)/g.test(o),s=i&&/OS\s(7|6_1_4)/g.test(o),u=/Android/g.test(o),l=!1,c=a?"mobile":r?"tablet":"desktop";if(o.indexOf("Android")>0)for(var d=o.split(";"),h=0,f=d.length;f>h;h++)if(d[h].indexOf("Android")>0){var p=d[h].split(" ");if(parseInt(p[p.length-1].split(".")[0])<3){l=!0;break}}return{screenWidth:function(){return t},profile:function(){return c},isTablet:function(){return r},isMobile:function(){return a},isDesktop:function(){return n},isAndroid:function(){return u},isAndroidLt3:function(){return l},isIOS:function(){return i},isIOS7:function(){return s},deviceTypeForAds:function(){return this.profile()},browserWidthForAds:function(){return Chorus.Environment.currentBreakpoint().name},doNotTrack:function(){var e;if(void 0!==navigator.doNotTrack)e=navigator.doNotTrack;else if(void 0!==window.doNotTrack)e=window.doNotTrack;else{if(void 0===navigator.msDoNotTrack)return"unsupported";e=navigator.msDoNotTrack}return/1|yes|true/.test(e)?"1":"0"}}}();var Kicksend={mailcheck:{threshold:3,defaultDomains:"yahoo.com google.com hotmail.com gmail.com me.com aol.com mac.com live.com comcast.net googlemail.com msn.com hotmail.co.uk yahoo.co.uk facebook.com verizon.net sbcglobal.net att.net gmx.com mail.com".split(" "),defaultTopLevelDomains:"co.uk com net org info edu gov mil".split(" "),run:function(e){e.domains=e.domains||Kicksend.mailcheck.defaultDomains,e.topLevelDomains=e.topLevelDomains||Kicksend.mailcheck.defaultTopLevelDomains,e.distanceFunction=e.distanceFunction||Kicksend.sift3Distance;var t=Kicksend.mailcheck.suggest(encodeURI(e.email),e.domains,e.topLevelDomains,e.distanceFunction);t?e.suggested&&e.suggested(t):e.empty&&e.empty()},suggest:function(e,t,o,a){if(e=e.toLowerCase(),e=this.splitEmail(e),t=this.findClosestDomain(e.domain,t,a)){if(t!=e.domain)return{address:e.address,domain:t,full:e.address+"@"+t}}else if(o=this.findClosestDomain(e.topLevelDomain,o),e.domain&&o&&o!=e.topLevelDomain)return t=e.domain,t=t.substring(0,t.lastIndexOf(e.topLevelDomain))+o,{address:e.address,domain:t,full:e.address+"@"+t};return!1},findClosestDomain:function(e,t,o){var a,r=99,n=null;if(!e||!t)return!1;o||(o=this.sift3Distance);for(var i=0;i<t.length;i++){if(e===t[i])return e;a=o(e,t[i]),r>a&&(r=a,n=t[i])}return r<=this.threshold&&null!==n?n:!1},sift3Distance:function(e,t){if(null==e||0===e.length)return null==t||0===t.length?0:t.length;if(null==t||0===t.length)return e.length;for(var o=0,a=0,r=0,n=0;o+a<e.length&&o+r<t.length;){if(e.charAt(o+a)==t.charAt(o+r))n++;else for(var i=r=a=0;5>i;i++){if(o+i<e.length&&e.charAt(o+i)==t.charAt(o)){a=i;break}if(o+i<t.length&&e.charAt(o)==t.charAt(o+i)){r=i;break}}o++}return(e.length+t.length)/2-n},splitEmail:function(e){if(e=e.split("@"),2>e.length)return!1;for(var t=0;t<e.length;t++)if(""===e[t])return!1;var o=e.pop(),a=o.split("."),r="";if(0==a.length)return!1;if(1==a.length)r=a[0];else{for(t=1;t<a.length;t++)r+=a[t]+".";2<=a.length&&(r=r.substring(0,r.length-1))}return{topLevelDomain:r,domain:o,address:e.join("@")}}}};window.jQuery&&function(e){e.fn.mailcheck=function(e){var t=this;if(e.suggested){var o=e.suggested;e.suggested=function(e){o(t,e)}}if(e.empty){var a=e.empty;e.empty=function(){a.call(null,t)}}e.email=this.val(),Kicksend.mailcheck.run(e)}}(jQuery);var Chorus=Chorus||{},handleRecaptchaLoad=function(){Chorus.Auth.actions.captcha.addAll()};Chorus.Auth=function(e){return{config:function(t){this.element={wrapper:e(".m-auth-modal__wrapper"),modal:e(".m-auth-modal"),close:e(".m-auth-modal__close"),body:e(".m-auth-modal__body"),form:e(".m-auth-modal__form"),loginTable:e(".m-auth-modal__login-table"),loadingMsg:e("#chorus-auth-loading-message")},this.authTriggers={data:e("[data-chorus-auth]"),goTo:e("[data-chorus-auth-goto]"),auto:e("[data-chorus-auth-auto]"),facebook:e('[data-chorus-auth-login="facebook"]'),openId:e('[data-chorus-auth-login="openid"]'),twitter:e('[data-chorus-auth-login="twitter"]'),yahoo:e('[data-chorus-auth-login="yahoo"]'),password:e("#chorus-auth-password")},this.globals={serializedForm:"",bindOnceExecuted:!1,dispatcherDefined:!!Chorus&&!!Chorus.EventDispatcher},this.openModalClass="-has-open-auth-modal",this.networkUrl=this.element.modal.data("chorus-auth-network-url"),Chorus.Auth.helpers.noCorsSupport()&&(this.networkUrl=Chorus.Auth.helpers.httpNetworkUrl()),t()},defaultAjaxOptions:{xhrFields:{withCredentials:!0}},init:function(){this.config(function(){Chorus.Auth.networkUrl&&(window.addEventListener&&window.addEventListener("message",function(e){var t=Chorus.Auth.helpers.httpNetworkUrl();if(e.origin===t&&"function"==typeof e.data.trim&&"{"===e.data.trim()[0]){var o=JSON.parse(e.data);o.is_from_chorus_auth&&Chorus.Auth.actions.callbacks.chorusAuth(o)}},!1),Chorus.Auth.events.bindOnce(),Chorus.Auth.helpers.placeholderPolyfill(),Chorus.Auth.helpers.checkForAutoLoad())})},events:{bindOnce:function(){Chorus.Auth.globals.bindOnceExecuted===!1&&(Util.UserAgentProfiler.isMobile()||Chorus.Auth.authTriggers.data.on("click",Chorus.Auth.modal.open),Chorus.Auth.globals.dispatcherDefined&&Chorus.EventDispatcher.subscribe("modal_closed_by_modaljs",Chorus.Auth.modal.forceClose),Chorus.Auth.globals.bindOnceExecuted=!0)},bind:function(){Chorus.Auth.authTriggers.goTo.on("click",Chorus.Auth.modal.goTo),Chorus.Auth.element.wrapper.on("click",Chorus.Auth.modal.close),Chorus.Auth.element.modal.find(Chorus.Auth.element.close).on("click",Chorus.Auth.modal.close),Chorus.Auth.authTriggers.password.on("submit",Chorus.Auth.actions.login.password);var e=Chorus.Auth.modal.goTo("login",!0);e.find('[name="username"]').on("change",Chorus.Auth.actions.validate.at_sign);var t=Chorus.Auth.modal.goTo("rec-migrate",!0);t.find("#rec-migrate-already").on("click",function(e){e.preventDefault(),Chorus.Auth.modal.goTo("rec-migrate-login")}),t.find("form").on("submit",Chorus.Auth.actions.form.startSubmission),t.find('[name="user[username]"]').on("focus blur",Chorus.Auth.actions.validate.username),t.find('[name="user[password]"]').on("blur",Chorus.Auth.actions.validate.password);var o=Chorus.Auth.modal.goTo("rec-migrate-login",!0);o.find("form").on("submit",Chorus.Auth.actions.form.startSubmission);var a=Chorus.Auth.modal.goTo("forgot",!0);a.find("form").on("submit",Chorus.Auth.actions.form.startSubmission);var r=Chorus.Auth.modal.goTo("forgot-username",!0);r.find("form").on("submit",Chorus.Auth.actions.form.startSubmission),Chorus.Auth.authTriggers.facebook.on("click",function(e){Chorus.Auth.actions.login.facebook(e)}),Chorus.Auth.authTriggers.twitter.on("click",function(e){Chorus.Auth.actions.login.twitter(e)}),Chorus.Auth.authTriggers.yahoo.on("click",function(e){Chorus.Auth.actions.login.yahoo(e)}),Chorus.Auth.authTriggers.openId.on("click",function(e){Chorus.Auth.actions.showOpenIdForm(e)}),Chorus.Auth.element.form.filter(".openid").on("submit",function(e){Chorus.Auth.actions.login.openId(e)});for(var n=["join","register-join"],i=0;i<n.length;i++){var s=Chorus.Auth.modal.goTo(n[i],!0);s.find('input[type="checkbox"]').on("change",Chorus.Auth.actions.validate.checkboxEnablesForm),s.find("form").on("submit",Chorus.Auth.actions.form.startSubmission)}Chorus.Auth.modal.goTo("umbel-permissions",!0).find("form").on("submit",Chorus.Auth.actions.form.startSubmission);var u=Chorus.Auth.modal.goTo("third-party-register",!0);u.find('[name="user[username]"]').on("focus",Chorus.Auth.actions.validate.validationEnablesForm),u.find('[name="user[username]"]').on("focus blur",Chorus.Auth.actions.validate.username),u.find("form").on("submit",Chorus.Auth.actions.form.startSubmission),Chorus.Auth.modal.goTo("captcha",!0).find("form").on("submit",Chorus.Auth.actions.form.startSubmission);var l=Chorus.Auth.modal.goTo("register",!0);l.find('[name="user[username]"]').on("blur",Chorus.Auth.actions.validate.username),l.find('[name="user[password]"]').on("blur",Chorus.Auth.actions.validate.password),l.find('[name="user[email]"]').on("blur",Chorus.Auth.actions.validate.email),l.find('[name="user[email]"]').on("blur",Chorus.Auth.actions.validate.suggestEmail),l.find("form").on("submit",Chorus.Auth.actions.form.startSubmission)}},actions:{validate:{email:function(e){var t=Chorus.Auth.actions.validate.getInputContext(e);t.errorId="email",_.isEmpty(t.value)?(t.status.removeClass("error success"),Chorus.Auth.actions.validate.errors.clear(t)):Chorus.Auth.actions.validate.testAgainstJSON("email_valid",{email:t.value},t)},suggestEmail:function(t){var o=Chorus.Auth.actions.validate.getInputContext(t);o.errorId="suggest-email",e(o.input).mailcheck({suggested:function(e,t){Chorus.Auth.actions.validate.errors.show(o,"Did you mean "+t.full+"?")},empty:function(e){Chorus.Auth.actions.validate.errors.clear(o)}})},at_sign:function(t){var o=Chorus.Auth.actions.validate.getInputContext(t);-1===o.value.indexOf("@")?e(".username-at-sign-warning").hide():e(".username-at-sign-warning").show()},username:function(e){var t=Chorus.Auth.actions.validate.getInputContext(e);t.errorId="username",_.isEmpty(t.value)||t.value==t.input.attr("placeholder")?t.status.removeClass("error success"):Chorus.Auth.actions.validate.testAgainstJSON("username_available",{username:t.value},t)},password:function(e){var t=Chorus.Auth.actions.validate.getInputContext(e);if(t.errorId="password",_.isEmpty(t.value))t.status.removeClass("error success");else{var o=t.value.length>=6&&t.value.match(/\d/)&&t.value.match(/\d/).length&&t.value.match(/[a-z]/i)&&t.value.match(/[a-z]/i).length?!0:!1;Chorus.Auth.actions.validate.addCheckOrX(o,t)}},checkboxEnablesForm:function(e){var t=Chorus.Auth.actions.validate.getInputContext(e);t.errorId="checkbox";var o=t.modalObj.find('[type="submit"]');t.input.is(":checked")?o.removeAttr("disabled"):o.attr("disabled",!0)},getInputContext:function(t){var o=e(t.target),a=o.parents(Chorus.Auth.element.body.selector),r={input:o,status:o.parent(),value:o.val(),modal:a.data("chorus-auth-modal"),modalObj:a,errorMsg:o.data("error-msg"),errorEl:o.parent().find("h6")};return r},testAgainstJSON:function(t,o,a){e.getJSON(Chorus.Auth.networkUrl+"/chorus_auth/"+t+".json?callback=?",o).success(function(e){Chorus.Auth.actions.validate.addCheckOrX(e,a)})},addCheckOrX:function(e,t){e.available||_.isBoolean(e)&&e?(t.status.addClass("success"),t.status.removeClass("error"),Chorus.Auth.actions.validate.errors.clear(t)):(t.status.addClass("error"),t.status.removeClass("success"),_.isUndefined(e.message)?Chorus.Auth.actions.validate.errors.show(t):Chorus.Auth.actions.validate.errors.show(t,e.message))},isFormValid:function(t){var o=e(t.target),a=o.find("fieldset").filter("[data-chorus-auth-validate]").length,r=o.find("fieldset").filter("[data-chorus-auth-validate].success").length;return a===r},errors:{show:function(t,o){var a=_.isUndefined(o)?t.errorMsg:o;t.status.find("#"+t.errorId).length||(e("<h6/>").appendTo(t.status).attr("id",t.errorId).text(a),t.status.hasClass("error")||(t.status.addClass("error"),t.status.removeClass("success")))},clear:function(e){e.status.find("#"+e.errorId).remove()}}},form:{startSubmission:function(t){var o=e(t.target).parents(Chorus.Auth.element.body.selector);switch(o.data("chorus-auth-modal")){case"forgot":Chorus.Auth.modal.spinner("Sending...");var a=e(t.target).find("[name='email']").val();e.ajax(_.extend({type:"post",url:Chorus.Auth.networkUrl+"/chorus_auth/request_password_reset.json",data:{email:a},dataType:"json",success:function(e){var t=Chorus.Auth.modal.goTo("forgot-result",!0);t.find(".auth-error").text(""),t.find(".success").text(e.message),"success"===e.message_type&&(t.find('[ data-chorus-auth-goto="forgot"]').hide(),t.find(".third-party").hide()),Chorus.Auth.modal.goTo("forgot-result")},error:function(e,t,o){var a=(JSON.parse(e.responseText),Chorus.Auth.modal.goTo("forgot-result",!0));a.find(".success").text(""),a.find(".auth-error").text(data.message),Chorus.Auth.modal.goTo("forgot-result")}},Chorus.Auth.defaultAjaxOptions));break;case"forgot-username":Chorus.Auth.modal.spinner("Sending...");var a=e(t.target).find("[name='email']").val();e.ajax(_.extend({type:"post",url:Chorus.Auth.networkUrl+"/chorus_auth/request_username_retrieval.json",data:{email:a},dataType:"json",success:function(e){var t=Chorus.Auth.modal.goTo("forgot-username-result",!0);t.find(".auth-error").text(""),t.find(".success").text(e.message),"success"===e.message_type&&(t.find('[ data-chorus-auth-goto="forgot-username"]').hide(),t.find(".third-party").hide()),Chorus.Auth.modal.goTo("forgot-username-result")},error:function(e,t,o){var a=(JSON.parse(e.responseText),Chorus.Auth.modal.goTo("forgot-username-result",!0));a.find(".success").text(""),a.find(".auth-error").text(data.message),Chorus.Auth.modal.goTo("forgot-username-result")}},Chorus.Auth.defaultAjaxOptions));break;case"join":Chorus.Auth.actions.form.submitJoin();break;case"register-join":Chorus.Auth.isCaptchaRequired?Chorus.Auth.modal.goTo("captcha"):Chorus.Auth.actions.form.completeSubmission();break;case"umbel-permissions":Chorus.Auth.actions.form.serialize(t.target),Chorus.Auth.modal.goTo("third-party-register");break;case"rec-migrate":Chorus.Auth.actions.validate.isFormValid(t)&&(Chorus.Auth.actions.form.serialize(t.target),Chorus.Auth.isCaptchaRequired=!1,Chorus.Auth.modal.goTo("register-join",!0).length?Chorus.Auth.modal.goTo("register-join"):Chorus.Auth.actions.form.completeSubmission());break;case"rec-migrate-login":t.preventDefault(),Chorus.Auth.actions.form.serialize(t.target),Chorus.Auth.actions.login.recLinkChorus(t);break;case"third-party-register":Chorus.Auth.actions.validate.isFormValid(t)&&(Chorus.Auth.actions.form.serialize(t.target),Chorus.Auth.isCaptchaRequired=!1,Chorus.Auth.modal.goTo("register-join",!0).length?Chorus.Auth.modal.goTo("register-join"):Chorus.Auth.actions.form.completeSubmission());break;case"captcha":Chorus.Auth.actions.form.serialize(t.target),Chorus.Auth.actions.form.completeSubmission(Chorus.Auth.actions.captcha.error);break;case"register":if(Chorus.Auth.actions.validate.isFormValid(t)){Chorus.Auth.provider="password",Chorus.Auth.actions.form.serialize(t.target),Chorus.Auth.actions.captcha.init("chorus-auth-register-recaptcha");var r=e(t.target).find("[name='user[username]']").val();Chorus.Auth.modal.goTo("captcha",!0).find("span.username").text(r),Chorus.Auth.isCaptchaRequired=!0,Chorus.Auth.modal.goTo("register-join",!0).length?Chorus.Auth.modal.goTo("register-join"):Chorus.Auth.modal.goTo("captcha")}}t.preventDefault()},completeSubmission:function(t){return e.ajax(_.extend({type:"post",url:Chorus.Auth.networkUrl+"/chorus_auth/register.json",data:Chorus.Auth.globals.serializedForm,dataType:"json",success:function(e){Chorus.Auth.actions.login.completeLogin("Register")},error:function(e,o,a){var r=JSON.parse(e.responseText);t(r.message)}},Chorus.Auth.defaultAjaxOptions)),Chorus.Auth.modal.spinner("Registering"),!1},submitJoin:function(){var t=Chorus.Auth.networkUrl+"/chorus_auth/join_community.json";return Chorus.Context.community_id&&(t=t+"?community_id="+Chorus.Context.community_id),e.ajax(_.extend({type:"post",url:t,dataType:"json",success:function(e){window.location.reload()},error:function(e,t,o){var a=JSON.parse(e.responseText);console.log(a.message)}},Chorus.Auth.defaultAjaxOptions)),Chorus.Auth.modal.spinner("Registering"),!1},serialize:function(t){_.isEmpty(Chorus.Auth.globals.serializedForm)||(Chorus.Auth.globals.serializedForm+="&"),Chorus.Auth.globals.serializedForm+=e(t).serialize()}},captcha:{recaptchaInstances:[],init:function(){window.grecaptcha?Chorus.Auth.actions.captcha.resetAll():e.getScript("https://www.google.com/recaptcha/api.js?onload=handleRecaptchaLoad&render=explicit")},resetAll:function(){window.grecaptcha&&Chorus.Auth.actions.captcha.recaptchaInstances.length>0&&Chorus.Auth.actions.captcha.recaptchaInstances.forEach(function(e){grecaptcha.reset(e)})},addAll:function(){var e={sitekey:document.querySelector("[data-recaptcha-site-id]").getAttribute("data-recaptcha-site-id")};Chorus.Auth.actions.captcha.recaptchaInstances=[grecaptcha.render("chorus-auth-login-recaptcha",e),grecaptcha.render("chorus-auth-register-recaptcha",e)]},error:function(e){Chorus.Auth.actions.captcha.init(),Chorus.Auth.modal.goTo("captcha",!0).find(".auth-error").text(e),Chorus.Auth.modal.goTo("captcha")}},callbacks:{thirdParty:function(e,t,o){var a=Chorus.Auth.modal.goTo("third-party-register",!0);if(!_.isUndefined(t)){var r=a.find('[name="user[username]"]');r.val(t),r.focus()}_.isUndefined(o)||a.find(".m-auth-modal__avatar").attr("src",o)},chorusAuth:function(e){if(e.logged_in)Chorus.Auth.actions.login.completeLogin("Login");else if(_.isUndefined(e.error))Chorus.Auth.actions.callbacks.thirdParty(e.provider,e.username,e.profile_image_url),"facebook"===e.provider?Chorus.Auth.modal.goTo("umbel-permissions"):Chorus.Auth.modal.goTo("third-party-register");else{var t=Chorus.Auth.modal.goTo("register",!0);t.find(".auth-error").text(e.error),Chorus.Auth.modal.goTo("register")}}},login:{yahoo:function(e){Chorus.Auth.actions.openAuthWindow(Chorus.Auth.networkUrl+"/chorus_auth/initiate_yahoo_auth"),Chorus.Auth.provider="yahoo",e.preventDefault()},openId:function(t){var o=e(t.target).find("[name='openid']").val();Chorus.Auth.actions.openAuthWindow(Chorus.Auth.networkUrl+"/chorus_auth/initiate_openid_auth?openid_url="+o),Chorus.Auth.provider="open_id",t.preventDefault()},twitter:function(e){var t=Chorus.Auth.networkUrl+"/chorus_auth/initiate_twitter_auth";Chorus.Auth.actions.openAuthWindow(t),Chorus.Auth.provider="twitter",e.preventDefault()},facebook:function(e){Chorus.Auth.actions.openAuthWindow(Chorus.Auth.networkUrl+"/chorus_auth/initiate_facebook_auth"),Chorus.Auth.provider="facebook",e.preventDefault()},gplus:function(t){Chorus.Auth.provider="google_plus",t.code&&t["g-oauth-window"]&&(Chorus.Auth.modal.spinner("Authenticating"),e.ajax(_.extend({type:"POST",url:Chorus.Auth.networkUrl+"/chorus_auth/finalize_google_plus_auth.json?",data:{code:t.code},success:function(e){Chorus.Auth.actions.callbacks.chorusAuth(e)},dataType:"json"},Chorus.Auth.defaultAjaxOptions)))},recLinkChorus:function(t){var o=e(t.target);return e.ajax(_.extend({type:"post",url:Chorus.Auth.networkUrl+"/chorus_auth/rec_link_chorus.json",data:Chorus.Auth.globals.serializedForm,dataType:"json",success:function(e){e.logged_in?Chorus.Auth.actions.login.completeLogin("Login"):("undefined"!=typeof e.message&&o.find(".auth-error").text(e.message),Chorus.Auth.modal.goTo("rec-migrate-login"))},error:function(e,t,o){JSON.parse(e.responseText)}},Chorus.Auth.defaultAjaxOptions)),Chorus.Auth.modal.spinner("Registering"),!1},password:function(t){var o=e(t.target),a=function(e){if(Chorus.Auth.provider="password",e.logged_in)Chorus.Auth.actions.login.completeLogin("Login");else{if("undefined"!=typeof e.next_action)return void Chorus.Auth.modal.goTo(e.next_action);e.captcha_required&&Chorus.Auth.actions.captcha.init("chorus-auth-login-recaptcha"),"undefined"!=typeof e.message&&o.find(".auth-error").text(e.message),Chorus.Auth.modal.goTo("login")}};e.ajax(_.extend({type:"POST",url:Chorus.Auth.networkUrl+"/chorus_auth/initiate_password_auth.json",data:o.serialize(),success:a,dataType:"json"},Chorus.Auth.defaultAjaxOptions)),Chorus.Auth.modal.spinner("Logging in..."),Chorus.DynamicSizedImages.applyTo(".m-auth-modal"),t.preventDefault()},completeLogin:function(e){setTimeout(function(){window.location.reload()},100)}},openAuthWindow:function(e){Chorus.Auth.modal.spinner("Authenticating");var t=window.open(e,"_blank","height=450,width=800,menubar=yes,status=yes,scrollbars=yes,resizable=yes,titlebar=yes,toolbar=no,menubar=yes,location=yes");t||alert("welp, window blocked")},resetLoginOptions:function(){Chorus.Auth.element.loginTable.each(function(){e(this).find("tr").not(":first").addClass("other")}),Chorus.Auth.element.form.filter(".openid").hide()},showOpenIdForm:function(t){var o=e(t.target),a=o.parents(Chorus.Auth.element.body.selector);a.find(Chorus.Auth.element.form).filter(".openid").toggle(),t.preventDefault()}},modal:{open:function(t){var o=_.isObject(t)?e(this).data("chorus-auth"):t;if(Chorus.Auth.helpers.noCorsSupport()&&Chorus.Auth.helpers.notOnNetworkDomain()){var a=Chorus.Auth.helpers.httpNetworkUrl(),r=window.location.href.split("?")[0];window.location.href=a+"/login?return_to="+r}else Chorus.Auth.element.modal.find('[data-chorus-auth-modal="'+o+'"]').show(),Chorus.Auth.globals.dispatcherDefined&&Chorus.EventDispatcher.publish("modal_open",{content:Chorus.Auth.element.modal});_.isObject(t)&&t.preventDefault(),Chorus.DynamicSizedImages.applyTo(".m-auth-modal"),Chorus.Auth.events.bind()},forceClose:function(){e("body").removeClass(Chorus.Auth.openModalClass),Chorus.Auth.element.wrapper.hide(),Chorus.Auth.element.modal.find("[data-chorus-auth-modal]").hide(),Chorus.Auth.actions.resetLoginOptions()},close:function(t){t.target===this&&(e("body").removeClass(Chorus.Auth.openModalClass),Chorus.Auth.element.wrapper.hide(),Chorus.Auth.element.modal.find("[data-chorus-auth-modal]").hide(),Chorus.Auth.actions.resetLoginOptions(),t.preventDefault())},goTo:function(t,o){var a=_.isObject(t)?e(this).data("chorus-auth-goto"):t,r=Chorus.Auth.element.body.filter('[data-chorus-auth-modal="'+a+'"]');return _.isUndefined(o)?(Chorus.Auth.element.body.filter(":visible").hide(),r.show(),void(_.isObject(t)&&t.preventDefault())):r},spinner:function(e){Chorus.Auth.element.loadingMsg.text(e),Chorus.Auth.modal.goTo("spinner")},moveIntoView:function(){var t=e(window).scrollTop();Chorus.Auth.element.modal.css("top",t)}},helpers:{placeholderPolyfill:function(){var t=document.createElement("input");"placeholder"in t||Chorus.Auth.element.modal.find("[placeholder]").focus(function(){var t=e(this);t.val()===t.attr("placeholder")&&(t.val(""),t.removeClass("placeholder"))}).blur(function(){var t=e(this);(""===t.val()||t.val()===t.attr("placeholder"))&&(t.addClass("placeholder"),t.val(t.attr("placeholder")))}).blur()},checkForAutoLoad:function(){if(1===Chorus.Auth.authTriggers.auto.length){var e=Chorus.Auth.authTriggers.auto.eq(0).data("chorus-auth-auto");Chorus.Auth.modal.open(e)}},httpNetworkUrl:function(){return null==Chorus.Auth.networkUrl?null:Chorus.Auth.networkUrl.replace(/^https:\/\//,"http://")},noCorsSupport:function(){return window.navigator.userAgent.match(/MSIE (6|7|8|9)/)},notOnNetworkDomain:function(){return 0!==window.location.href.indexOf(Chorus.Auth.helpers.httpNetworkUrl())}}}}(jQuery),jQuery(function(){Chorus.Auth.init()}),/*
 * Lazy Load - jQuery plugin for lazy loading images
 *
 * Copyright (c) 2007-2012 Mika Tuupola
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 * Project home:
 *   http://www.appelsiini.net/projects/lazyload
 *
 * Version:  1.8.0.sbn
 * - Hacked so that it lazy loads non-IMG tags
 * - Hacked so that the scroll event that ends up firing lazyload:appear is debounced
 * - Hacked so resize event is debounced
 * - Hacked so data attributes are not cached via jQuery (neccesary for optimization)
 *
 */
function(e,t){var o=e(t);e.fn.lazyload=function(a){function r(e,t){return"undefined"!=typeof _?_.debounce(e,t):e}function n(){var t=0;s.each(function(){var o=e(this);if(!u.skip_invisible||o.is(":visible"))if(e.abovethetop(this,u)||e.leftofbegin(this,u));else if(e.belowthefold(this,u)||e.rightoffold(this,u)){if(++t>u.failure_limit)return!1}else o.trigger("lazyload:appear")})}var i,s=this,u={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:!0,appear:null,load:null,scrollInterval:200,resizeInterval:250};if(a&&(void 0!==a.failurelimit&&(a.failure_limit=a.failurelimit,delete a.failurelimit),void 0!==a.effectspeed&&(a.effect_speed=a.effectspeed,delete a.effectspeed),e.extend(u,a)),i=void 0===u.container||u.container===t?o:e(u.container),0===u.event.indexOf("scroll")){var l=function(e){return n()};i.bind(u.event,r(l,u.scrollInterval))}this.each(function(){var o=this,a=e(o);o.loaded=!1,o.error_event_set=!1;var n=4e3,i=4,l=0,c=function(){if(!this.loaded){if(u.appear){var r=s.length;u.appear.call(o,r,u)}if("IMG"===this.tagName)e("<img />").bind("load",function(){a.hide().attr("src",a.attr("data-"+u.data_attribute))[u.effect](u.effect_speed),o.loaded=!0;var t=e.grep(s,function(e){return!e.loaded});if(s=e(t),u.load){var r=s.length;u.load.call(o,r,u)}}).bind("error",function(){o.error_event_set||t.setTimeout(e.proxy(d,this),n),o.error_event_set=!0}).attr("src",a.attr("data-"+u.data_attribute));else{a.css("background-image","url('"+a.attr("data-"+u.data_attribute)+"')")[u.effect](u.effect_speed),o.loaded=!0;var i=e.grep(s,function(e){return!e.loaded});if(s=e(i),u.load){var r=s.length;u.load.call(o,r,u)}}}},d=function(){if(l+=1,i>=l){e(this).bind("error",function(){t.setTimeout(e.proxy(d,this),n)});var o=this.src.split("?")[0];this.src=o+"?"+(new Date).getTime()}};if(a.one("lazyload:appear",c),0!==u.event.indexOf("scroll")){var h=function(e){o.loaded||a.trigger("lazyload:appear")};a.bind(u.event,r(h,u.scrollInterval))}});var c=function(e){n()};return o.bind("resize",r(c,u.resizeInterval)),n(),this},e.belowthefold=function(a,r){var n;return n=void 0===r.container||r.container===t?o.height()+o.scrollTop():e(r.container).offset().top+e(r.container).height(),n<=e(a).offset().top-r.threshold},e.rightoffold=function(a,r){var n;return n=void 0===r.container||r.container===t?o.width()+o.scrollLeft():e(r.container).offset().left+e(r.container).width(),n<=e(a).offset().left-r.threshold},e.abovethetop=function(a,r){var n;return n=void 0===r.container||r.container===t?o.scrollTop():e(r.container).offset().top,n>=e(a).offset().top+r.threshold+e(a).height()},e.leftofbegin=function(a,r){var n;return n=void 0===r.container||r.container===t?o.scrollLeft():e(r.container).offset().left,n>=e(a).offset().left+r.threshold+e(a).width()},e.inviewport=function(t,o){return!(e.rightofscreen(t,o)||e.leftofscreen(t,o)||e.belowthefold(t,o)||e.abovethetop(t,o))},e.extend(e.expr[":"],{"below-the-fold":function(t){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return e.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!e.rightoffold(t,{threshold:0})},"in-viewport":function(t){return!e.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return e.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!e.rightoffold(t,{threshold:0})}})}(jQuery,window);var Chorus=Chorus||{};Chorus.DynamicSizedImages=function(e){function t(t,o){var s={failure_limit:20,load:function(){var t=e(this),o=t.parent(".image-window");if(t.is("img")&&(o.length>0?(t.css({position:"absolute",top:Math.round((o.outerHeight()-t.outerHeight())/2),left:Math.round((o.outerWidth()-t.outerWidth())/2)}),"undefined"==typeof t.attr("height")&&t.css("height","auto")):"undefined"==typeof t.attr("height")&&t.css("height","auto")),t.addClass(n),t.removeClass(i),t.removeClass("m-chorus-asset__in-entry-body"),e.fn.playGIF){var a=Chorus.Context.gif_opts||{},r={on:"touchstart",off:"touchstart"};if(Chorus.Context&&Chorus.Context.main_link_color&&(a.circleBackgroundColor=Chorus.Context.main_link_color,a.circleTextColor="FFFFFF"),"undefined"==typeof PLAYGIF_DISABLE_FLAG){var s=e('.m-entry__body img[src*=".gif"], .m-entry__body img[data-original*=".gif"], .m-block__fanshot-media img[src*=".gif"]'),u=e('.m-entry__top-hero .m-entry__photo img[data-original*=".gif"]');s.length+u.length===1?PLAYGIF_DISABLE_FLAG=!0:s&&s.length>0&&(PLAYGIF_DISABLE_FLAG=!1,Modernizr.touch?s.playGIF(r):s.playGIF(a))}Modernizr.touch?t.playGIF(r):t.playGIF(a)}},threshold:800};o&&e.extend(s,o),t=e("undefined"!=typeof t&&null!==t?t:"body");var u=t.find(r+":visible").not("."+i+", ."+n),l=[],c=[];u.each(function(){var t,o,r,n,u,d=e(this),h=d.attr("data-imgkey"),f=d.data("chorus-asset-id");if("undefined"!=typeof h){if(s.parentDimensionSlc){var p=d.closest(s.parentDimensionSlc);t=p.outerWidth(),o=p.outerHeight()}t||(t=d.outerWidth()),o||(o=d.outerHeight()),0==o&&(r=d.data("ratio"),o="undefined"!=typeof r&&r>0?Math.ceil(t/r):t),d.is("img")&&(r=d.data("ratio"),n=d.parent(".image-window"),"undefined"!=typeof r&&r>0&&(o=Math.ceil(t/r)),n.length>0&&(t=Math.ceil(n.outerWidth()),o=Math.ceil(n.outerHeight())),o>0&&d.css("height",o)),"undefined"!=typeof window.devicePixelRatio&&(t=Math.ceil(t*window.devicePixelRatio),o=Math.ceil(o*window.devicePixelRatio)),Chorus.Context&&"racked"===Chorus.Context.network_slug&&(t=Math.ceil(1.3*t),o=Math.ceil(1.3*o)),/\.(png|jpg|jpeg)$/i.test(d.attr("data-original"))&&a.webp&&!Chorus.Modernizr.touch&&(u="webp");var m=h+":"+t+"x"+o+(u?":"+u:"");l.push(m),d.attr("data-dim",t+"x"+o),d.addClass(i)}else if("undefined"!=typeof f){t=d.outerWidth(),o=d.outerHeight(),d.is("img")&&(r=d.data("ratio"),n=d.parent(".image-window"),"undefined"!=typeof r&&r>0&&(o=Math.ceil(t/r)),n.length>0&&(t=Math.ceil(n.outerWidth()),o=Math.ceil(n.outerHeight())),o>0&&d.css("height",o)),"undefined"!=typeof window.devicePixelRatio&&(t=Math.ceil(t*window.devicePixelRatio),o=Math.ceil(o*window.devicePixelRatio)),"racked"===Chorus.Context.network_slug&&(t=Math.ceil(1.3*t),o=Math.ceil(1.3*o));var g=f+":"+t+":"+o;c.push(g),d.data("asset-key",g),d.addClass(i)}else d.lazyload(s)}),(0!==l.length||0!==c.length)&&(e.each([c,l],function(e,t){t.sort(function(e,t){return+e.split(":")[0]-+t.split(":")[0]})}),e.ajax({type:"GET",url:"/chorus_page/optimally_sized_images",dataType:"json",contentType:"application/json",timeout:1e4,data:{imgkeys:l.join(","),asset_keys:c.join(",")},success:function(t){var o=t.urls,a={};_.forEach(o,function(e,t){var o=t.replace(/\:webp|\:jp2/,"");a[o]=e}),o=a,u.each(function(){var t,a=e(this);t=a.attr("data-imgkey")?a.attr("data-imgkey")+":"+a.attr("data-dim"):a.data("asset-key");var r=o[t];"undefined"!=typeof r&&(a.attr("data-original",r),a.lazyload(s))})}}))}e(document).ready(function(){Chorus.DynamicSizedImages.init(),Chorus.EventDispatcher&&Chorus.EventDispatcher.publish("dynamic-images-available",{},!0)});var o={},a={webp:!1,jp2:!1},r=".vox-lazy-load",n="lazy-loaded",i="lazy-loading";return o.init=function(){function e(){if(Chorus.Modernizr.localstorage&&window.localStorage.getItem("supportsWebp"))a.webp="true"===window.localStorage.getItem("supportsWebp")?!0:!1,r();else{var e=new Image;e.onload=function(){a.webp=!!(e.height>0&&e.width>0),Chorus.Modernizr.localstorage&&window.localStorage.setItem("supportsWebp",a.webp),r()},e.onerror=function(){a.webp=!1,Chorus.Modernizr.localstorage&&window.localStorage.setItem("supportsWebp",a.webp),r()},e.src="data:image/webp;base64,UklGRiYAAABXRUJQVlA4IBoAAAAwAQCdASoBAAEAAIAOJaQAA3AA/v89WAAAAA=="}}function r(){Chorus&&Chorus.Context&&Chorus.Context.defer_image_loading?Chorus.Context.defer_image_loading=!1:o.initUI(),Chorus.EventDispatcher&&Chorus.EventDispatcher.subscribe("moduleInserted",function(e){t(e.modules)})}e()},o.initUI=function(e,o){t(e,o)},o.applyTo=function(e,o){t(e,o)},o}(jQuery),/*! usertiming v0.1.6 */
!function(e){"use strict";"undefined"==typeof e&&(e={}),"undefined"==typeof e.performance&&(e.performance={}),e._perfRefForUserTimingPolyfill=e.performance,e.performance.userTimingJsNow=!1,e.performance.userTimingJsNowPrefixed=!1,e.performance.userTimingJsUserTiming=!1,e.performance.userTimingJsUserTimingPrefixed=!1,e.performance.userTimingJsPerformanceTimeline=!1,e.performance.userTimingJsPerformanceTimelinePrefixed=!1;var t,o,a=[],r=[],n=null;if("function"!=typeof e.performance.now){for(e.performance.userTimingJsNow=!0,r=["webkitNow","msNow","mozNow"],t=0;t<r.length;t++)if("function"==typeof e.performance[r[t]]){e.performance.now=e.performance[r[t]],e.performance.userTimingJsNowPrefixed=!0;break}var i=+new Date;e.performance.timing&&e.performance.timing.navigationStart&&(i=e.performance.timing.navigationStart),"function"!=typeof e.performance.now&&(e.performance.now=Date.now?function(){return Date.now()-i}:function(){return+new Date-i})}var s=function(){},u=function(){},l=[],c=!1,d=!1;if("function"!=typeof e.performance.getEntries||"function"!=typeof e.performance.mark){for("function"==typeof e.performance.getEntries&&"function"!=typeof e.performance.mark&&(d=!0),e.performance.userTimingJsPerformanceTimeline=!0,a=["webkit","moz"],r=["getEntries","getEntriesByName","getEntriesByType"],t=0;t<r.length;t++)for(o=0;o<a.length;o++)n=a[o]+r[t].substr(0,1).toUpperCase()+r[t].substr(1),"function"==typeof e.performance[n]&&(e.performance[r[t]]=e.performance[n],e.performance.userTimingJsPerformanceTimelinePrefixed=!0);s=function(e){l.push(e),"measure"===e.entryType&&(c=!0)};var h=function(){c&&(l.sort(function(e,t){return e.startTime-t.startTime}),c=!1)};if(u=function(e,o){for(t=0;t<l.length;)l[t].entryType!==e||"undefined"!=typeof o&&l[t].name!==o?t++:l.splice(t,1)},"function"!=typeof e.performance.getEntries||d){var f=e.performance.getEntries;e.performance.getEntries=function(){h();var t=l.slice(0);return d&&f&&(Array.prototype.push.apply(t,f.call(e.performance)),t.sort(function(e,t){return e.startTime-t.startTime})),t}}if("function"!=typeof e.performance.getEntriesByType||d){var p=e.performance.getEntriesByType;e.performance.getEntriesByType=function(o){if("undefined"==typeof o||"mark"!==o&&"measure"!==o)return d&&p?p.call(e.performance,o):[];"measure"===o&&h();var a=[];for(t=0;t<l.length;t++)l[t].entryType===o&&a.push(l[t]);return a}}if("function"!=typeof e.performance.getEntriesByName||d){var m=e.performance.getEntriesByName;e.performance.getEntriesByName=function(o,a){if(a&&"mark"!==a&&"measure"!==a)return d&&m?m.call(e.performance,o,a):[];"undefined"!=typeof a&&"measure"===a&&h();var r=[];for(t=0;t<l.length;t++)("undefined"==typeof a||l[t].entryType===a)&&l[t].name===o&&r.push(l[t]);return d&&m&&(Array.prototype.push.apply(r,m.call(e.performance,o,a)),r.sort(function(e,t){return e.startTime-t.startTime})),r}}}if("function"!=typeof e.performance.mark){for(e.performance.userTimingJsUserTiming=!0,a=["webkit","moz","ms"],r=["mark","measure","clearMarks","clearMeasures"],t=0;t<r.length;t++)for(o=0;o<a.length;o++)n=a[o]+r[t].substr(0,1).toUpperCase()+r[t].substr(1),"function"==typeof e.performance[n]&&(e.performance[r[t]]=e.performance[n],e.performance.userTimingJsUserTimingPrefixed=!0);var g={};"function"!=typeof e.performance.mark&&(e.performance.mark=function(t){var o=e.performance.now();if("undefined"==typeof t)throw new SyntaxError("Mark name must be specified");if(e.performance.timing&&t in e.performance.timing)throw new SyntaxError("Mark name is not allowed");g[t]||(g[t]=[]),g[t].push(o),s({entryType:"mark",name:t,startTime:o,duration:0})}),"function"!=typeof e.performance.clearMarks&&(e.performance.clearMarks=function(e){e?g[e]=[]:g={},u("mark",e)}),"function"!=typeof e.performance.measure&&(e.performance.measure=function(t,o,a){var r=e.performance.now();if("undefined"==typeof t)throw new SyntaxError("Measure must be specified");if(!o)return void s({entryType:"measure",name:t,startTime:0,duration:r});var n=0;if(e.performance.timing&&o in e.performance.timing){if("navigationStart"!==o&&0===e.performance.timing[o])throw new Error(o+" has a timing of 0");n=e.performance.timing[o]-e.performance.timing.navigationStart}else{if(!(o in g))throw new Error(o+" mark not found");n=g[o][g[o].length-1]}var i=r;if(a)if(i=0,e.performance.timing&&a in e.performance.timing){if("navigationStart"!==a&&0===e.performance.timing[a])throw new Error(a+" has a timing of 0");i=e.performance.timing[a]-e.performance.timing.navigationStart}else{if(!(a in g))throw new Error(a+" mark not found");i=g[a][g[a].length-1]}var u=i-n;s({entryType:"measure",name:t,startTime:n,duration:u})}),"function"!=typeof e.performance.clearMeasures&&(e.performance.clearMeasures=function(e){u("measure",e)})}"undefined"!=typeof define&&define.amd?define([],function(){return e.performance}):"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=e.performance)}("undefined"!=typeof window?window:void 0),/*!
 * IframeClient v0.0.5
 * Copyright 2015, Vox Media
 * Released under MIT license
 */
function(e,t){var o={debug:!1,create:function(o,a){return t(this,o,a,e)},isInIframe:function(){try{return e.parent&&e.self!==e.top}catch(t){return!0}},error:function(e){if(this.debug)throw e}};"object"==typeof module&&module.exports?module.exports=o:e.IframeClient=o}(window,function(e,t,o,a){function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var n=r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r(),i="@app",s=t||"xframe",u="@res",l=200,c=[],d={},h={},f=0,p=null,m=null;return{host:o||"*",get id(){return n},src:function(e){return"string"==typeof e&&(e=document.querySelector(e)),e&&e instanceof Element&&e.contentWindow&&(e=e.contentWindow),e&&"function"==typeof e.postMessage?e:null},post:function(t,o,a){if(t=this.src(t),!t||!o)return e.error("invalid post");var r="string"==typeof o?{message:o}:o;if(void 0!==a&&(r.value=a),r.message){r[i]=s;try{t.postMessage(JSON.stringify(r),this.host)}catch(n){e.error(n)}}},request:function(t,o,a,r,i){function s(){var e=!1;for(var t in d)if(d.hasOwnProperty(t)){var o=d[t];o.attempts++<o.timeout/l?(u.post(o.src,o.data),e=!0):u.end(t,new Error("request timeout"))}p=e?setTimeout(s,l):null}if(t=this.src(t),!t||!o)return e.error("invalid request");var u=this,c=n+"-"+("0000"+f++).slice(-4),h=d[c]={timeout:i||15e3,attempts:0,src:t,cb:r,data:{message:o,value:a,id:c}};return p?this.post(t,h.data):s(),c},end:function(e,t){var o=e.id||e,a=t&&t.abort;if(d.hasOwnProperty(o)){var r=d[o];delete d[o],a||"function"!=typeof r.cb||r.cb(t||null,e.value)}},on:function(e,t,o){return c.push({message:e,fn:t,ctx:o}),this},listen:function(){function e(e,t){for(var o,a=0;a<c.length;a++){var r=c[a];r.message===t.message&&(o=r.fn.call(r.ctx,e,t.value))}return o}if(!m){var t=this;m=function(o){var a,r="*"===t.host||String(o.origin).indexOf(t.host)>=0;if(r&&/^\{.*\}$/.test(o.data))try{a=JSON.parse(o.data)}catch(n){a=null}if(r&&a&&a[i]===s)if(a.id){var l=a.message===u;l&&d.hasOwnProperty(a.id)?t.end(a):l||h.hasOwnProperty(a.id)||(h[a.id]=!0,t.post(o.source,{message:u,value:e(o,a)||"success",id:a.id}))}else e(o,a)},a.addEventListener("message",m)}return this},stopListening:function(){return m&&(a.removeEventListener("message",m),m=null),this},dispose:function(){clearInterval(p),this.stopListening()}}}),function(e){function t(e){return new o(e)}function o(e){if(!a)throw"volume is not installed";this.el=a.src(e)}var a,r={production:"http://volume.vox-cdn.com",sandbox:"http://volume-staging.vox-cdn.com",development:"http://localhost:4000"};t.embedHost=r[Chorus.Context.environment],t.selectAllEmbeds=function(){return document.querySelectorAll('iframe[src^="'+this.embedHost+'/embed"]')},t.install=function(e){e&&(this.embedHost=e);var o,r=(this.selectAllEmbeds(),document.querySelectorAll(".volume-video"));for(a?a.host=this.embedHost:a=IframeClient.create("volume",this.embedHost).on("analytics",function(e,o){t.reportEvent(o)}).on("pauseOthers",function(e,o){t.postToAll("pause",null,e.source)}).on("host",function(e,t){return{url:location.href,origin:location.origin,title:document.title,api:!0}}).listen(),o=0;o<r.length;o+=1)this.embedVideo(r[o]);return this},t.uninstall=function(){a&&(a.dispose(),a=null)},t.reportEvent=function(e){Chorus.Analytics.event(e)},t.embedVideo=function(e){var t=e.getAttribute("data-volume-uuid");if(t){var o={placement:e.getAttribute("data-volume-placement"),tracking:e.getAttribute("data-analytics-placement"),player_type:e.getAttribute("data-volume-player-choice"),start_time:e.getAttribute("data-volume-start-time")},a=String(e.getAttribute("data-volume-autoplay"));("1"===a||"true"===a)&&(o.autoplay=!0);var r=Object.keys(o).filter(function(e){return void 0!==o[e]}).map(function(e){return e+"="+encodeURIComponent(o[e])});e.className=e.className.replace(/volume-video|p-scalable-video/g,"")+" p-scalable-video",e.innerHTML='<iframe src="'+this.embedHost+"/embed/"+t+"?"+r.join("&")+'" frameborder="0" allowfullscreen></iframe>'}},t.postToAll=function(e,t,o){for(var r=this.selectAllEmbeds(),n=0;n<r.length;n++){var i=a.src(r[n]);i!==o&&a.post(i,e,t)}},o.prototype={play:function(e){var t="play";return e&&e.request?this.request(t):this.post(t)},pause:function(e){var t="pause";return e&&e.request?this.request(t):this.post(t)},post:function(e,t){return a&&a.post(this.el,e,t),this},request:function(e,t,o){return a&&a.request(this.el,e,t,o),this}},jQuery(document).ready(function(){e.volume=t.install()})}(this);var Volume=Volume||{};Volume.Config=function(e){function t(e){if(0!==Object.keys(e).length){u=e.configs;var t=Util.UserAgentProfiler;if(t.isMobile())var o="mobile";else if(t.isTablet())var o="tablet";else var o="desktop";var a=e.device[o];a&&(s=a)}}function o(e){return"undefined"!=typeof s&&s.hasOwnProperty(e)?s[e]:void 0}function a(e){var t=o(e);if("undefined"!=typeof t)return t.preferred}function r(e,t){var a=o(e);if("undefined"!=typeof a){var r=t||a.preferred,n=a[r];return n?u[n]:void 0}}function n(e){"function"==typeof e?l=e:"undefined"==typeof e&&l()}function i(e){"undefined"!=typeof e&&(t(e),Volume.Config.ready())}var s,u,l=function(){};return{init:i,ready:n,placementConfig:r,preferredPlacementPlayer:a}}(jQuery),jQuery(function(){Volume.Config.init(window.volume_profile)});var Volume=Volume||{};Volume.Player=function(e){function t(){var t=e(a);t.each(function(t,a){var r=e(a),n=r.attr("id");"undefined"==typeof r.data("volume-uuid")&&o(n)})}function o(t){var o=e("#"+t),a=o.data("volume-id"),r=(o.data("volume-placement"),o.data());"undefined"!=typeof r&&(r.autoplay=r.volumeAutoplay),"undefined"!=typeof t&&"undefined"!=typeof a&&Chorus&&Chorus.VideoContext&&Chorus.VideoContext.createVolumePlayer(t,a,r)}var a=".volume-video:not(.prevent-init)";return{init:t,create:o}}(jQuery),Volume.Config.ready(function(){Volume.Player.init()});var Chorus=Chorus||{};!function(e){function t(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];n[o]=function(){return console.log('[VideoContext]: The "'+o+'" method is deprecated. Please use "'+e+'" instead.'),n[e].apply(n,arguments)}}}function o(){function e(e){return function(){for(var t in n.players)"function"==typeof n.players[t][e]&&n.players[t][e]()}}o.init||(o.init=!0,jQuery(document).on("pause",e("suspend")).on("resume",e("resume")).find("head").append('<script src="https://resources.amazonwebapps.com/v1/latest/Amazon-Web-App-API.min.js" async></script>'))}var a="viewedVideos",r=1e5,n=Chorus.VideoContext={videos:{},players:{},getVideo:function(e){return this.videos[e]||null},getVideoById:function(e){for(var t in this.videos)if(this.videos[t].id===e)return this.videos[t]},addPlacementForId:function(t,o){var a=this.getVideoById(t);a&&(a=e.extend({},a),a.placement=o,this.addVideo(a))},addVideo:function(e){e instanceof Array==0&&(e=[e]);for(var t=0;t<e.length;t++){var o=e[t];o.preview_urls=o.preview_urls||{},o.provider_video_data=o.provider_video_data||{},o.provider_video_id=o.provider_video_id||"",o.placement=o.placement||null,o.type=o.provider_video_type=o.provider_video_type||"other",o.title=o.title||"No Title",delete o.hasViewport,this.videos[o.placement||o.id]=o}return this},addVolumeVideo:function(e){e instanceof Array==0&&(e=[e]);for(var t=0;t<e.length;t++){var o=e[t];this.videos[o.id]=o}return this},createVolumePlayer:function(t,a,r){var n=this.getVideo(a);if(n){for(var i=e("#"+t),s=i.data("volume-placement"),u=r.volumePlayerChoice,l=Volume.Config.preferredPlacementPlayer(s),c=["ooyala","youtube","brightcove"],d=u||l,h=n[d+"_id"],f=0;null==h&&f<c.length;f++)d=c[f],h=n[d+"_id"];if(null!=h){var r=e.extend(Volume.Config.placementConfig(s,d),r),p={ooyala:OoyalaWrapper,youtube:YoutubeWrapper,brightcove:BrightcoveWrapper,embed:EmbedWrapper}[d];if(p){var m,g=i.attr("id");p!==BrightcoveWrapper&&(g=i.attr("id")+"-target",m='<div id="'+g+'"></div>'),this.destroyPlacement(g),i.addClass("p-scalable-video"),i.append(m),this.players[a]=new p(g,n,r),this.createViewport(g,a,r)}o()}}},addOoyalaVideo:function(e,t,o){var a={id:"ooyala"+Object.keys(this.videos).length,provider_video_id:e,provider_video_type:"ooyala",placement:o,title:t};return this.addVideo(a),a.id},destroyPlayer:function(e){var t=this.players[e];t&&"function"==typeof t.destroy&&t.destroy(),delete this.players[e]},destroyAllPlayers:function(){for(var e in this.players)this.destroyPlayer(e)},destroyPlacement:function(e){for(var t in this.players){var o=this.players[t];if(o.elementId===e)return this.destroyPlayer(t)}},createPlayer:function(e,t,a){a=a||{};var r=this.getVideo(t);if(r){var n={brightcove:BrightcoveWrapper,ooyala:OoyalaWrapper,youtube:YoutubeWrapper,embed:EmbedWrapper}[r.type];n&&(this.destroyPlacement(e),this.players[t]=new n(e,r,a),this.createViewport(e,t,a)),o()}},createViewport:function(t,o,a){if(a=a||{},!a.disableViewport){var r=this.getVideo(o),n=this;if(r&&!r.hasViewport){r.hasViewport=!0,"string"==typeof t&&(t=e("#"+t));var i=this.formatVideoEvent("view",r,t,function(){"ooyala"===r.type&&n.addViewedVideo(r)});Chorus.Analytics.trackElementView(t,i)}}},createViewportProxy:function(t,o,a){var r="data-analytics-placement",n=e(o).attr(r,e(t).attr(r));return this.createViewport(n,a)},createViewportGroup:function(t,o,a){"function"==typeof o&&(a=o,o=null),o=o||"data-placement",e(t).each(function(){var t=e(this);Chorus.Analytics.onElementView(t,function(){var e=t.find("["+o+"]").map(function(){return this.getAttribute(o)});n.trackPlacementsInViewport(e),"function"==typeof a&&a()})})},trackPlacementsInViewport:function(e){for(var t=0;t<e.length;t++){var o=this.getVideo(e[t]);o&&!o.hasViewport&&(o.hasViewport=!0,Chorus.Analytics.event(this.formatVideoEvent("view",o)))}},formatVideoEvent:function(t,o,a,r){var n=o.placement;!n&&a&&(n="data-analytics-placement",a=e("string"==typeof a?"#"+a:a),n=a.closest("["+n+"]").attr(n));var i="embed"===o.type,s=i?o.provider_video_id.replace(/.*embed\/([^"']+).*/,"$1"):o.id;return{eventCategory:i?"videotemp":"video",eventAction:[o.type||"volume",t,n||"other"].join(":"),eventLabel:[o.title,s].join(" | "),nonInteraction:"view"===t,eventCallback:r}},getViewedVideos:function(){return Chorus.Modernizr.localstorage?JSON.parse(localStorage.getItem(a)||"[]"):[]},addViewedVideo:function(e){var t=this.getViewedVideos();t.unshift(e),Chorus.Modernizr.localstorage&&localStorage.setItem(a,JSON.stringify(t.slice(0,6)))},findUnviewedVideo:function(e,t){var o=this.getViewedVideos(),a={};o.push(t||{}),o.forEach(function(e){e.id&&(a[e.id]=1),e.provider_video_id&&(a[e.provider_video_id]=1)});for(var r=0;r<e.length;r++){var n=e[r];if(!a[n.id]&&!a[n.provider_video_id])return n}return e[0]}};t("addVideo","addVideos","addChorusVideos"),t("addOoyalaVideo","addCustomVideo","addVideoFromOoyalaIdWithTitle"),n.Wrapper={$el:null,elementId:"",meta:{},options:{},player:null,played:!1,destroy:function(){},suspend:function(){},resume:function(){},pub:function(e,t){var o=Chorus.EventDispatcher;o&&o.publish(e,t||{player:this.player})},perfMark:function(){var e=window.performance;e&&e.mark&&e.mark.apply(e,arguments)},perfMeasure:function(e){var t=window.performance;if(t&&t.measure){t.measure.apply(t,arguments);var o=t.getEntriesByName(e),a=o[o.length-1],n=Math.floor(a.duration);if(n>r)return;var i=[this.meta.type,e].join(":"),s=[this.meta.title,this.meta.id].join(" | ");Chorus.Analytics.event("video",i,s,n,!0)}},perfLoadStart:function(){"undefined"==typeof BOOMR||this._timer||(this._timer=BOOMR.requestStart("tag"))},perfLoadComplete:function(){this._timer&&(this._timer.loaded(),delete this._timer)},markAsViewed:function(e){(!e||this.options.setPlayedVideos)&&n.addViewedVideo(this.meta)},formatEvent:function(e,t){return n.formatVideoEvent(e,this.meta,this.$el,t)}}}(jQuery),BrightcoveWrapper.prototype=jQuery.extend({},Chorus.VideoContext.Wrapper,{THUMB_FALLBACK:"http://assets.volume.voxmedia.com/static-images/default-thumb.jpg",insertVideoTag:function(e){var t=this.getVideoClass(),o='<video class="video-js '+t+'"';o+=' id="brightcove_'+this.meta.id+'"',o+=' data-player="'+this.options.player_id+'"',o+=' data-account="'+this.options.account_id+'"',o+=' data-embed="default"',o+="></video>",jQuery(o).appendTo(e)},getVideoClass:function(){var e=[Chorus.Context.network_slug];return"true"===this.options.hideAdOverlay&&e.push("hide-ad-overlay"),"true"===this.options.hideAdCountdown&&e.push("hide-ad-countdown"),e.join(" ")},setupPlayer:function(e){var t=this;videojs("brightcove_"+t.meta.id).ready(function(){var o=this,a=t.getEmbedCode(),r=function(){this.currentTime()>0&&(this.off("timeupdate",r),t.perfMark("playbackStart"),t.perfMeasure("ttff","playbackRequest","playbackStart"))};t.player=o,t.options.onCreate(),"true"==t.options.enableSocialSharing&&"function"==typeof this.social&&o.social({title:t.meta.title,displayAfterVideo:!0,description:t.meta.description,services:{facebook:!0,twitter:!0,pinterest:!1,tumblr:!1,linkedin:!1,google:!1}}),o.preload("metadata"),e.autoplay?o.autoplay(!0):null!=t.meta.brightcove_thumbnail?o.poster(t.meta.brightcove_thumbnail):o.poster(t.THUMB_FALLBACK),this.one("loadedmetadata",function(e){t.perfMark("brightcoveReady"),t.perfMeasure("loadtime","brightcoveInitializeStart","brightcoveReady")}),this.one("firstplay",function(e){t.perfMark("playbackRequest"),t.options.onPlay(),Chorus.Analytics.event(t.formatEvent("play")),this.on("timeupdate",r)}),this.one("error",function(e){console.log("Brightcove: error"),console.log(e),Chorus.Analytics.event(t.formatEvent("error"))}),a.indexOf("onceux.unicornmedia.com")>=0?o.onceux({metadataUri:a,contentHeaders:!0}):o.src({src:a})})},getEmbedCode:function(){var e=this.options,t=this.meta;if(null!==e.applicationId&&null!==e.deliveryType&&null!==e.fileType&&null!==e.extension){var o="0c2129c5-42b8-49e0-aa4c-f560c7bc0ba7",a="",r=["http://onceux.unicornmedia.com/now/ads/vmap",e.deliveryType,e.fileType,o,e.applicationId,t.brightcove_uuid,"content."+e.extension].join("/");return null!==t.brightcove_query_params&&null!==e.umoprofiles?a=t.brightcove_query_params+"&umoprofiles="+e.umoprofiles:null!==e.umoprofiles?a="?umoprofiles="+e.umoprofiles:null!==t.brightcove_query_params&&(a=t.brightcove_query_params),r+a}return t.brightcove_id},destroy:function(){this.player&&this.player.dispose()},getPlayerUrl:function(e){var t=["//players.brightcove.net",e.account_id,e.player_id+"_default","index.min.js"];return t.join("/")}}),OoyalaWrapper.prototype=jQuery.extend({},Chorus.VideoContext.Wrapper,{destroy:function(){this.player&&this.player.destroy()},suspend:function(){this.player&&(this.suspendState=this.player.getState(),this.player.pause())},resume:function(){var e=this.suspendState;!this.player||"playing"!==e&&"buffering"!==e||(this.player.play(),this.suspendState=null)},getOoyalaParams:function(e){for(var t=["//player.ooyala.com/v3/",e.player_id,"?"],o=["namespace","platform","version","tweaks"],a=0;a<o.length;a++){var r=o[a];e.hasOwnProperty(r)&&t.push(r,"=",e[r],"&")}return t.join("")}}),YoutubeWrapper.initQueue=[],YoutubeWrapper.prototype=jQuery.extend({},Chorus.VideoContext.Wrapper,{destroy:function(){this.player&&this.player.destroy()},suspend:function(){this.player&&(this.suspendState=this.player.getPlayerState(),this.player.stopVideo())},resume:function(){var e=this.suspendState;!this.player||e!==YT.PlayerState.PLAYING&&e!==YT.PlayerState.BUFFERING||(this.player.playVideo(),this.suspendState=null)}}),EmbedWrapper.prototype=jQuery.extend({},Chorus.VideoContext.Wrapper,{destroy:function(){this.$el.empty()}});var Chorus=Chorus||{};Chorus.Video=Chorus.Video||{},Chorus.Video.youtubeApiLoaded=!1,Chorus.Video.loadYoutubeApi=function(){jQuery.getScript("//www.youtube.com/iframe_api"),Chorus.Video.youtubeApiLoaded=!0},Chorus.Video.wrapVideoIframe=function(){var e=jQuery,t=e(this),o="",a=t.attr("src");if(!t.parent().hasClass("chorus-video-embed")&&!t.parent().attr("data-volume-uuid")){if(!a||!/youtube|livestream|vimeo|vine|hulu|dailymotion|instagram/.test(a))return!0;/hulu\.com/.test(a)?(t.attr("width","100%"),t.attr("height","100%")):/instagram\.com/.test(a)?o=" instagram":/vine\.co/.test(a)&&(o=" vine"),t.attr("src",a),t.wrap('<div class="video-wrap'+o+'"></div>')}},Chorus.Video.fixLegacyOoyalaPlayer=function(){var e=jQuery;e("div[id*=ooyalaPlayer]").each(function(){e(this).css({height:"100%",width:"100%"})})},Chorus.Video.playInViewport=function(e){var t=500,o=[],a=[];e.each(function(){this.pause(),o.push(this)});var r=function(){for(var e,n=[];e=o.pop();)Util.inViewport(e)?(e.play(),a.push(e)):n.push(e);for(o=n,n=[];e=a.pop();)Util.inViewport(e)?n.push(e):(e.pause(),o.push(e));a=n,setTimeout(r,t)};r()},Chorus.Video.autoplay=!1,Chorus.Video.checkForAutoplay=function(){return window.history.length<=1?!1:Chorus.Video.autoplay?!0:Util.isReferrerCurrentDomain()&&jQuery("body").hasClass("video-entry")&&Util.UserAgentProfiler.isDesktop()},Chorus.Video.init=function(e){e=e||{};var t=jQuery,o=e.callback;e=t.extend({checkForExistingPlayer:!1},e),Chorus.Video.fixLegacyOoyalaPlayer(),t(".chorus-video-embed").each(function(a,r){if(!e.checkForExistingPlayer||!t(r).hasClass("chorus-video-player-loaded")){var n=t.extend({},e,{autoplay:0===a?Chorus.Video.checkForAutoplay():!1,callback:function(e){Chorus.VideoContext.ooyalaPlayer=e,t(r).addClass("chorus-video-player-loaded"),Chorus.EventDispatcher.publish("ooyalaPlayerLoaded",{ooyalaPlayer:e}),"function"==typeof o&&o.call(r,e)}});Chorus.VideoContext.createPlayer(r.id,t(r).data("chorus-video-id"),n)}})},window.jQuery&&jQuery(function(){Chorus.Video.init()});