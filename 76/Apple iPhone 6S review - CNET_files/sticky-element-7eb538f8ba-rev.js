define(["jquery","version!fly/managers/debug","managers/waypoints","version!fly/components/base","version!libs/waypoints/inview"],function(e,t,i){t=t.init("stickyElement"),i.init(),e.widget("cnet.stickyElement",e.fly.base,{options:{classFixed:"fixed",classHidden:"hidden",classPlaceholder:"sticky-element-placeholder",offset:0,primaryEdge:"top"},$placeholder:null,waypoint:null,_create:function(){this._setup(),this._setupPlaceholder(),this._setupEvents()},_setupPlaceholder:function(){this.$placeholder=e('<div class="'+this.options.classPlaceholder+" "+this.options.classHidden+'"></div>'),this.$placeholder.height(this.$element.outerHeight(!0)),"top"===this.options.primaryEdge?this.$element.before(this.$placeholder):"bottom"===this.options.primaryEdge&&this.$element.after(this.$placeholder)},_setupEvents:function(){var e=this;0===this.options.offset?this.waypoint=new Waypoint.Inview({element:this.$placeholder[0],entered:function(t){("top"===e.options.primaryEdge&&"up"===t||"bottom"===e.options.primaryEdge&&"down"===t)&&e._unstick()},exit:function(t){("top"===e.options.primaryEdge&&"down"===t||"bottom"===e.options.primaryEdge&&"up"===t)&&e._stick()}}):this.waypoint=new Waypoint({element:this.$placeholder[0],handler:function(t){"top"===e.options.primaryEdge&&"up"===t||"bottom"===e.options.primaryEdge&&"down"===t?e._unstick():e._stick()},offset:this.options.offset})},_stick:function(){this.$placeholder.removeClass(this.options.classHidden),this.$element.addClass(this.options.classFixed),this.$element.trigger("stickyElementStuck")},_unstick:function(){this.$placeholder.addClass(this.options.classHidden),this.$element.removeClass(this.options.classFixed),this.$element.trigger("stickyElementUnstuck")}})});