function get_url_param(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)";var c=new RegExp(b);var d=c.exec(window.location.href);if(d==null)return"sb_error_code";else return d[1]}function sb_play_video(){if(get_url_param("sb_video_id")!="sb_error_code"&&get_url_param("sb_partner_id")!="sb_error_code"){getVideo(get_url_param("sb_video_id"),get_url_param("sb_partner_id"))}else{}}function runHtml5Fallback(a){sbhtml.createSpringboards(a)}var globalna;if(sbhtml==undefined){var sbhtml={}}if(externalCounter==undefined){var externalCounter=0}if(sbhtml.springboards==undefined){sbhtml.videoObj=null;sbhtml.currentItem=0;sbhtml.springboards={};sbhtml.springboardVideoObjects={};sbhtml.externalCounter=0;sbhtml.sbElementId=null;sbhtml.debug=false;sbhtml.uagent=navigator.userAgent.toLowerCase();sbhtml.detectMobileArray=["iphone","ipad","ipod","android","blackberry"];sbhtml.cookieValue="sbanalytics";sbhtml.createSpringboards=function(a,b){if(sbhtml.detectSmartphone()||sbhtml.debug){var c=[];if(a!=null){sbhtml.sbElementId=a;c.push(document.getElementById(a))}else{c=sbhtml.collectSbObjects()}var d=c.length;for(var e=0;e<d;e++){try{vidObject=c[e];vidObject.itemNumbers=0;if(b!=undefined){vidObject.itemNumbers=b}vidObject.playlist={};vidObject.turns=0;vidObject.playlist.currentItem=0;vidObject.currentItem=externalCounter;vidObject=sbhtml.getValuesForVidObject(vidObject);sbhtml.runHtml5(vidObject);externalCounter++}catch(f){}}}else return};sbhtml.collectSbObjects=function(){var a=[];var b=document.getElementsByTagName("object");for(var c=0;c<b.length;c++){if(/\bSpringboardPlayer\b/.test(b[c].className)){a.push(b[c])}}return a};sbhtml.getValuesForVidObject=function(vidObj){var childrenNodes=vidObj.childNodes;var tagName;var returnValue=null;if(!vidObj.flashVars)vidObj.flashVars={};for(var i=0;i<childrenNodes.length;i++){if(childrenNodes[i].nodeType!=1){continue}tagName=childrenNodes[i].tagName.toLowerCase();if(tagName=="param"){if(sbhtml.debug){vidObj.flashVars["cmsUrl"]="dev.publishers.springboard.gorillanation.com"}else{vidObj.flashVars["cmsUrl"]="cms.springboard.gorillanation.com"}if(childrenNodes[i].name=="movie"){var cn=childrenNodes[i].value;var fv=cn.split("/");var fvl=fv.length;vidObj.flashVars["xmlUrl"]=cn;if(cn.indexOf("playlist")!=-1&&cn.indexOf("config")!=-1){var pP=/playlist["']:["'](.*)["']/;var f=cn.match(pP);if(f[1]!=undefined){vidObj.flashVars["externalPlaylist"]=f[1]}else{throw new Error("[EXTERNAL PLAYLIST][getValuesForVidObject] Playlist not found.")}var pC=/superconfig\/(.*).js/;var conId=cn.match(pC);if(conId[1]!=undefined){vidObj.flashVars["widgetId"]=conId[1]}else{throw new Error("[EXTERNAL PLAYLIST][getValuesForVidObject] No widget id found.")}}else if(cn.indexOf("clip")!=-1){function trim(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"").replace(/([\s]+)/g,"")}cn=cn.replace(/\n/g,"");cn=trim(cn);var pat=/config={(.*)}/gi;var externalConfig=null;var ka=cn.match(pat);if(ka[0]!=undefined){var configString=ka[0].replace(/config=/g,"");externalConfig=eval("("+configString+")")}vidObj.flashVars["clipPath"]="http://test.springboardplatform.com/storage/test.com/conversion/472311.mp4";vidObj.flashVars["clipTitle"]="Undefined";vidObj.flashVars["clipVideoId"]=0;if(externalConfig!=null&&typeof externalConfig=="object"){if(externalConfig.clip!=undefined){vidObj.flashVars["clipPath"]=externalConfig.clip.url||"http://test.springboardplatform.com/storage/test.com/conversion/472311.mp4";vidObj.flashVars["clipTitle"]=externalConfig.clip.title||"Undefined";vidObj.flashVars["clipVideoId"]=externalConfig.clip.video_id||0;vidObj.flashVars["clipSnapshot"]=externalConfig.clip["sb:snapshot"].url||""}}i=/\/([0-9a-zA-z]+)\.js/gi;var n=i.exec(cn);vidObj.flashVars["widgetId"]=n[1]}else{for(j=2;j<fvl;j++){if(j==2){vidObj.flashVars["cdnUrl"]=fv[j]}if(j==5){vidObj.flashVars["mode"]=fv[j]}if(j==6){vidObj.flashVars["widgetId"]=fv[j]}if(vidObj.flashVars["mode"]!="youtube"){if(j==7){vidObj.flashVars["partnerId"]=fv[j]}if(j==8){vidObj.flashVars["contentId"]=fv[j]}}else{if(j==7){vidObj.flashVars["contentId"]=fv[j]}vidObj.flashVars["partnerId"]=0}}}}}}return vidObj};sbhtml.ajaxRequest=function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(window.ActiveXObject){for(var b=0;b<a.length;b++){try{return new ActiveXObject(a[b])}catch(c){}}}else if(window.XMLHttpRequest)return new XMLHttpRequest;else return false};sbhtml.runHtml5=function(a){var b=sbhtml.formVideoTagFromInfo(a);a.videoElement=b;a.videoElement.id=a.id;var c=undefined;for(videoObjectKey in sbhtml.springboardVideoObjects){if(sbhtml.springboardVideoObjects[videoObjectKey].id==a.id){c=videoObjectKey}}if(c==undefined){sbhtml.springboardVideoObjects[a.currentItem]=a}else{a.currentItem=c;sbhtml.springboardVideoObjects[c]=a}sbhtml.springboards[a.id]=a;a.parentNode.replaceChild(b,a);if(a.flashVars["externalPlaylist"]!=undefined){var d=new sbhtml.ajaxRequest;d.open("GET",a.flashVars["externalPlaylist"],false);d.send();d=d.responseXML;if(d!=undefined&&d!=null){sbhtml.springboardVideoObjects[a.currentItem].playlist=sbhtml.createExternalPlaylistFromXML(d);sbhtml.addScriptTag(a,"handleVideoResponse")}else{throw new Error("XML is empty or in wrong format!!!")}}else if(a.flashVars["clipPath"]!=undefined){sbhtml.addScriptTag(a,"handleVideoResponseClip")}else{sbhtml.addScriptTag(a,"handleVideoResponse")}};sbhtml.createExternalPlaylistFromXML=function(a){var b=a.getElementsByTagName("item");var c={};if(b!=undefined&&b.length>0){for(var d in b){if(b[d].hasChildNodes){var e=b[d].childNodes;var f={};f.Video={};for(var g in e){if(c.VideoList==undefined){c.VideoList=[]}f.Video[e[g].tagName]=e[g].textContent;if(e[g].tagName=="media:content"){f.Video["url"]=e[g].attributes.getNamedItem("url").nodeValue}if(e[g].tagName=="sb:snapshot"){f.Video["snapshot"]=e[g].attributes.getNamedItem("url").nodeValue}if(e[g].tagName=="siteId"){f.Video["site_id"]=e[g].textContent}}c.VideoList.push(f)}}}return c};sbhtml.addScriptTag=function(a,b){a.width=escape(a.width);a.height=escape(a.height);if(a.flashVars["externalPlaylist"]!=undefined||a.flashVars["clipPath"]!=undefined){var c="http://"+a.flashVars["cmsUrl"]+"/xml_feeds_advanced/html5v2/58/config/0/"+b+"/vid_"+a.id+"/"+a.id+"/"+a.width+"/"+a.height+"/"+a.flashVars["widgetId"]+"/"+a.currentItem+"/0"}else{var c="http://"+a.flashVars["cmsUrl"]+"/xml_feeds_advanced/html5v2/"+a.flashVars["partnerId"]+"/"+a.flashVars["mode"]+"/"+a.flashVars["contentId"]+"/"+b+"/vid_"+a.id+"/"+a.id+"/"+a.width+"/"+a.height+"/"+a.flashVars["widgetId"]+"/"+a.currentItem+"/"+a.itemNumbers}var d=document.createElement("script");d.type="text/javascript";d.src=c;d.async=true;d.charset="utf-8";var e=document.getElementsByTagName("head").item(0);e.appendChild(d)};sbhtml.handleVideoResponse=function(a,b,c){if(a!=""){var d=sbhtml.springboardVideoObjects[b];d.widgetConfig=c;d.videoElement.videoInfo={};if(a.VideoList==undefined){d.jsonResponse=d.playlist;d.playlist.currentItem=0;d.videoElement.videoInfo.partnerId=d.widgetConfig.WidgetPlayer.partner_id;if(d.flashVars["mode"]!="youtube"){}}else{d.jsonResponse=a}if(d.flashVars["mode"]!="youtube"){d.playlist.playlistLength=d.jsonResponse.VideoList.length}sbhtml.refreshVideoData(d);if(d.flashVars["mode"]!="youtube"){sbhtml.attachEvents(d)}}};sbhtml.handleVideoResponseClip=function(a,b,c){if(a!=""){var d=sbhtml.springboardVideoObjects[b];d.widgetConfig=c;var e={};e.VideoList=[];e.currentItem=0;var f={};f.Video={};f.Video["url"]=d.flashVars["clipPath"];f.Video["title"]=d.flashVars["clipTitle"];f.Video["id"]=d.flashVars["clipVideoId"]==undefined?0:d.flashVars["clipVideoId"];f.Video["site_id"]=d.widgetConfig.WidgetPlayer.partner_id;f.Video["snapshot"]=d.flashVars["clipSnapshot"]!=undefined?d.flashVars["clipSnapshot"]:"";e.VideoList.push(f);d.playlist=e;d.playlist.playlistLength=d.playlist.VideoList.length;d.jsonResponse=e;d.videoElement.videoInfo={};sbhtml.refreshVideoData(d);sbhtml.attachEvents(d)}};sbhtml.refreshVideoDataWidget=function(a,b){sbhtml.listWidgetCheck=true;for(videoObjectKey in sbhtml.springboardVideoObjects){if(sbhtml.springboardVideoObjects[videoObjectKey].id==a){sbhtml.refreshVideoData(sbhtml.springboardVideoObjects[videoObjectKey],b);sbhtml.removeEvents(sbhtml.springboardVideoObjects[videoObjectKey]);sbhtml.attachEvents(sbhtml.springboardVideoObjects[videoObjectKey]);sbhtml.springboardVideoObjects[videoObjectKey].videoElement.load();break}}};sbhtml.refreshVideoData=function(a,b){if(a!=null){if(a.flashVars["mode"]=="youtube"){var c=document.getElementById(a.videoElement.id);var d=document.createElement("iframe");d.className="youtube-player";d.width=a.widgetConfig.WidgetPlayer.width;d.height=a.widgetConfig.WidgetPlayer.height;d.frameBorder=0;d.src="http://www.youtube.com/embed/"+a.flashVars["contentId"]+"?controls=1&enablejsapi=1";c.parentNode.replaceChild(d,c);return false}if(a.jsonResponse!=null&&a.jsonResponse.VideoList!=null&&a.jsonResponse.VideoList!=""){a.videoElement.autoplay=false;if(a.playlist.currentItem==0&&a.widgetConfig.WidgetFeature.autoPlay==1){a.videoElement.autoplay=true}if(a.playlist.playlistLength>1&&a.playlist.currentItem!=0&&a.widgetConfig.WidgetFeature.continousPlay==1){a.videoElement.autoplay=true}a.playlist.currentItem=b!=null?b:a.playlist.currentItem;a.videoElement.src=a.jsonResponse.VideoList[a.playlist.currentItem].Video.url;a.videoElement.id=a.id;a.videoElement.setAttribute("items",a.playlist.playlistLength);var e=a.jsonResponse.VideoList[a.playlist.currentItem].Video.url;var f=e.substr(e.lastIndexOf("."));if(f.toLowerCase()==".flv"&&a.playlist.playlistLength>1&&a.playlist.currentItem<a.playlist.playlistLength-1){a.playlist.currentItem++;sbhtml.refreshVideoData(a)}else{a.videoElement.title=a.videoElement.videoInfo.videoTitle=a.jsonResponse.VideoList[a.playlist.currentItem].Video.title;a.videoElement.poster=a.jsonResponse.VideoList[a.playlist.currentItem].Video.snapshot;a.videoElement.videoInfo.partnerId=a.jsonResponse.VideoList[a.playlist.currentItem].Video.site_id;a.videoElement.videoInfo.videoId=a.jsonResponse.VideoList[a.playlist.currentItem].Video.id}}}};sbhtml.populateAnalyticsRequest=function(a){var b=new sbhtml.ajaxRequest;var c=window.location.protocol+"//"+window.location.host;var d=a.videoElement.videoInfo;var e=[];e["sbct"]=sbhtml.time();e["sbvol"]=d.volume;e["sbva"]=d.videoAction;e["sbvt"]=escape(d.videoTitle);e["sbhn"]=c;e["sbtp"]=d.timePlayed;e["sbvlen"]=d.videoLength;e["sbuv"]=sbhtml.getUnique(a);e["sbpid"]=d.partnerId==undefined?a.siteId:d.partnerId;e["sbvid"]=d.videoId==undefined?0:d.videoId;e["sbpl"]=a.flashVars["widgetId"];e["sbaty"]="c";e["sbmob"]=1;var f=[];for(var g in e){if(typeof e[g]!="function"){f.push(g+"="+e[g])}}b.open("GET",a.widgetConfig.WidgetPlayer.analyticsUrl+"?"+f.join("&"),true);b.setRequestHeader("Accept-Sb","sb");b.send(null)};sbhtml.playNext=function(a){if(a.playlist.playlistLength>1&&a.playlist.currentItem<a.playlist.playlistLength-1){a.playlist.currentItem++;sbhtml.refreshVideoData(a)}else if(a.playlist.playlistLength>1&&a.playlist.currentItem==a.playlist.playlistLength-1){if(a.turns<3){a.playlist.currentItem=0;sbhtml.refreshVideoData(a)}a.turns++}};sbhtml.failed=function(a,b){if(a.target.error!=null){switch(a.target.error.code){case a.target.error.MEDIA_ERR_ABORTED:sbhtml.playNext(b);break;case a.target.error.MEDIA_ERR_NETWORK:sbhtml.playNext(b);break;case a.target.error.MEDIA_ERR_DECODE:sbhtml.playNext(b);break;case a.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:sbhtml.playNext(b);break;default:sbhtml.playNext(b);break}}else{sbhtml.playNext(b)}};sbhtml.formVideoTagFromInfo=function(a){var b=document.createElement("video");if(a.width.indexOf("%")!=-1){b.style.width=a.width}else{b.width=a.width}if(a.height.indexOf("%")!=-1){b.style.height=a.height}else{b.height=a.height}b.controls=true;b.onerror=function(b){sbhtml.failed(b,a)};if(sbhtml.detectAndroid()){sbhtml.addClickHandlerToVid(b)}return b};sbhtml.detectSmartphone=function(){var a=false;for(var b=0;b<sbhtml.detectMobileArray.length;b++){if(sbhtml.uagent.search(sbhtml.detectMobileArray[b])!=-1){a=true;break}a=false}if(a)return true;else return false};sbhtml.detectAndroid=function(){if(sbhtml.uagent.search("android")>-1)return true;else return false};sbhtml.addClickHandlerToVid=function(a){a.addEventListener("click",function(a){return function(){a.play()}}(a))};sbhtml.sbRemoveListeners=function(){if(typeof document.addEventListener!="undefined"){document.removeEventListener("DOMContentLoaded",sbhtml.createSpringboard,false);document.removeEventListener("load",sbhtml.createSpringboards,false)}else if(typeof window.attachEvent!="undefined"){window.detachEvent("onload",sbhtml.createSpringboards)}};sbhtml.time=function(){var a=new Date;var b=a.getTime();return b};sbhtml.getUnique=function(a){if(sbhtml.readCookie(a)){return 0}else{sbhtml.setCookie(a);if(sbhtml.readCookie(a)){return 1}else{return 0}}},sbhtml.setCookie=function(a){if(a.videoElement.videoInfo.partnerId==undefined){sbhtml.cookieName="sbvideo_"+a.siteId}else{sbhtml.cookieName="sbvideo_"+a.videoElement.videoInfo.partnerId}var b=new Date;var c=new Date;c.setTime(b.getTime()+36e5*24);document.cookie=sbhtml.cookieName+"="+escape(sbhtml.cookieValue)+";expires="+c.toGMTString()};sbhtml.readCookie=function(a){if(a.videoElement.videoInfo.partnerId==undefined){sbhtml.cookieName="sbvideo_"+a.siteId}else{sbhtml.cookieName="sbvideo_"+a.videoElement.videoInfo.partnerId}var b=new RegExp("[; ]"+sbhtml.cookieName+"=([^\\s;]*)");var c=(" "+document.cookie).match(b);if(sbhtml.cookieName&&c)return unescape(c[1]);return""};sbhtml.buildSbPlayersIntoHtml5AfterPageLoad=function(){if(sbhtml.sbElementId==null){sbhtml.sbRemoveListeners();sbhtml.createSpringboards()}};if(typeof document.addEventListener!="undefined"){document.addEventListener("load",sbhtml.buildSbPlayersIntoHtml5AfterPageLoad,false);document.addEventListener("DOMContentLoaded",sbhtml.buildSbPlayersIntoHtml5AfterPageLoad,false)}else if(typeof window.attachEvent!="undefined"){window.attachEvent("onload",sbhtml.buildSbPlayersIntoHtml5AfterPageLoad)}sbhtml.bind=function(a,b,c){if(typeof document.addEventListener!="undefined"){a.addEventListener(b,c,false)}else if(typeof window.attachEvent!="undefined"){a.attachEvent(b,c)}};sbhtml.unbind=function(a,b,c,d){if(typeof document.addEventListener!="undefined"){a.removeEventListener(b,c,false)}else if(typeof window.attachEvent!="undefined"){a.detachEvent(b,c)}};sbhtml.attachEvents=function(a){var b=a.videoElement;b.vidObj=a;sbhtml.bind(b,"loadedmetadata",sbhtml.loadMetaDataEvent);sbhtml.bind(b,"ended",sbhtml.endEvent);sbhtml.bind(b,"timeupdate",sbhtml.trackAnalyticsEvent)};sbhtml.removeEvents=function(a){var b=a.videoElement;sbhtml.unbind(b,"loadedmetadata",sbhtml.loadMetaDataEvent);sbhtml.unbind(b,"ended",sbhtml.endEvent);sbhtml.unbind(b,"timeupdate",sbhtml.trackAnalyticsEvent)};sbhtml.loadMetaDataEvent=function(a){var b=a.target;b.videoInfo.videoLength=b.duration.toFixed();var c=(b.duration/4).toFixed();if(b.type!="ad"){b.analytics={VP_START:{val:false,cue:0},VP_25:{val:false,cue:c},VP_50:{val:false,cue:c*2},VP_75:{val:false,cue:c*3},VP_END:{val:false,cue:b.videoInfo.videoLength}}}};sbhtml.trackAnalyticsEvent=function(a){var b=a.target;var c=b.vidObj;var d=c.videoElement.currentTime.toFixed();for(var e in c.videoElement.analytics){if(d==c.videoElement.analytics[e].cue&&c.videoElement.analytics[e].val==false){c.videoElement.videoInfo.volume=(b.volume*100).toFixed();c.videoElement.videoInfo.timePlayed=d;c.videoElement.videoInfo.videoAction=e.toString();c.videoElement.analytics[e].val=true;sbhtml.populateAnalyticsRequest(c)}}};sbhtml.endEvent=function(a){try{var b=a.target;var c=b.vidObj;if(c!=null&&c.jsonResponse!=null&&c.playlist.currentItem<c.playlist.playlistLength-1){c.playlist.currentItem++;sbhtml.refreshVideoData(c)}else if(c.playlist.playlistLength>=0&&c.playlist.currentItem==c.playlist.playlistLength-1&&c.widgetConfig.WidgetFeature.recyclePlaylist==1){c.playlist.currentItem=0;sbhtml.refreshVideoData(c)}}catch(d){}}}